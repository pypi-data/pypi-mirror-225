"use strict";(self.webpackChunk_jupyterlab_nbgallery_instrumentation=self.webpackChunk_jupyterlab_nbgallery_instrumentation||[]).push([[568],{568:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var l=n(87),o=n(524),i=n(931),a=n(144),s=n(24),c=n(569),r=n.n(c);const u={id:"@juptyerlab-nbgallery/instrumentation",autoStart:!0,requires:[l.ISettingRegistry],activate:async(e,t)=>{let n={},l=!1;i.NotebookActions.executionScheduled.connect(((e,t)=>{if(l){let e,l;l=t.notebook,e=t.cell;const o=new Date;n[e.id]=new Object,n[e.id].startTime=o.getTime(),n[e.id].cellIndex=l.activeCellIndex,console.log(e)}})),i.NotebookActions.executed.connect(((e,t)=>{const{cell:o,notebook:i,success:c}=t;if(l&&o instanceof a.CodeCell){const e=new Date;console.log("Post execution"),function(e,t,n,l){let o;if(o=e.model.metadata.toJSON().gallery,o){let i=new Object;i.success=n,i.md5=s.Md5.hashStr(t.model.value.text),i.runtime=l,i.uuid=o.uuid||o.link||o.clone;let a=o.gallery_url;console.log(a),a.length>0&&i.uuid.length>0&&r().ajax({method:"POST",headers:{Accept:"application/json"},url:a+"/executions",data:i,xhrFields:{withCredentials:!0}}),console.log("Made it here"+e+t+n+l),console.log(o.uuid)}}(i,o,c,e.getTime()-n[o.id].startTime)}})),Promise.all([e.restored,t.load("@jupyterlab-nbgallery/instrumentation:instrumentation")]).then((([,e])=>{try{!function(e){r().ajax({method:"GET",headers:{Accept:"application/json"},url:o.PageConfig.getBaseUrl()+"jupyterlab_nbgallery/instrumentation",cache:!1,xhrFields:{withCredentials:!0},success:function(t){1==t.NBGALLERY_ENABLE_INSTRUMENTATION||e.get("enabled").composite?(e.set("enabled",!0),l=!0):l=!1}})}(e)}catch(e){console.error(`Problem initializing instrumentation \n ${e}`)}}))}}}}]);