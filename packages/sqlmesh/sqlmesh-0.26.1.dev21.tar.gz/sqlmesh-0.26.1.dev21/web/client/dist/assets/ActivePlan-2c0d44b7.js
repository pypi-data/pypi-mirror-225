import{A as w,u as A,n as r,r as p,j as e,e as b,F as i,s as n,B as k,c as C,w as S,t as d,G as E}from"./index-ff1743b2.js";import{T as l}from"./TasksOverview-e2a0cfc3.js";import{k as g}from"./popover-a777e0dc.js";import{$ as F}from"./transition-65d8b341.js";import"./pluralize-1a9dd2e8.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./context-d92d8d28.js";function $({plan:a}){const x=w(),h=A(t=>t.environment),s=r(t=>t.state),o=r(t=>t.setState),c=r(t=>t.setAction),[y,u]=p.useState(!1);function f(){o(n.Cancelling),c(d.Cancelling),E(x).catch(console.error).finally(()=>{c(d.None),o(n.Cancelled)})}return e.jsx(g,{onMouseEnter:()=>{u(!0)},onMouseLeave:()=>{u(!1)},className:"relative flex px-2",children:()=>e.jsxs(e.Fragment,{children:[e.jsx("span",{className:b("inline-block ml-1 px-2 py-[3px] rounded-[4px] text-xs font-bold cursor-default",N(s)),children:a==null?0:1}),e.jsx(F,{show:y,as:p.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:e.jsx(g.Panel,{className:"absolute right-1 z-10 mt-8 transform",children:e.jsxs("div",{className:"overflow-hidden rounded-lg bg-theme shadow-lg ring-1 ring-black ring-opacity-5",children:[e.jsx(l,{tasks:a.tasks,children:({total:t,completed:v,models:m,completedBatches:j,totalBatches:P})=>e.jsxs(e.Fragment,{children:[e.jsx(l.Summary,{environment:h.name,planState:s,headline:"Most Recent Plan",completed:v,total:t,completedBatches:j,totalBatches:P,updateType:a.type===i.Virtual?"Virtual":"Backfill",updatedAt:a.updated_at}),m!=null&&e.jsx(l.Details,{models:m,showBatches:a.type!==i.Virtual,showVirtualUpdate:a.type===i.Virtual,showProgress:!0})]})}),e.jsx("div",{className:"my-4 px-4",children:s===n.Applying&&e.jsx(k,{size:C.sm,variant:S.Danger,className:"mx-0",onClick:t=>{t.stopPropagation(),f()},children:"Cancel"})})]})})})]})})}function N(a){return a===n.Finished?"bg-success-500 text-light":a===n.Failed?"bg-danger-500 text-light":a===n.Applying?"bg-secondary-500 text-light":"bg-neutral-100 text-neutral-500"}export{$ as default};
