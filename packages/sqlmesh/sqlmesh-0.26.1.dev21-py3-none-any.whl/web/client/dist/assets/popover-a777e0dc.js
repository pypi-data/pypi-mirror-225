import{r as u,$ as T}from"./index-ff1743b2.js";import{l as ee,S as X,D as j,y as K,G as me,n as oe,J as le,s as ce,o as $,A as ye,B as Se,E as Ee,H as ge,c as $e,u as G,d as q,X as z,I as H,q as de,g as te,i as ne,C as ve,O as A,M as _,h as he,T as Ie,a as N,r as fe,j as Te,t as R,N as re}from"./transition-65d8b341.js";function pe(e){var t;if(e.type)return e.type;let s=(t=e.as)!=null?t:"button";if(typeof s=="string"&&s.toLowerCase()==="button")return"button"}function xe(e,t){let[s,y]=u.useState(()=>pe(e));return ee(()=>{y(pe(e))},[e.type,e.as]),ee(()=>{s||t.current&&t.current instanceof HTMLButtonElement&&!t.current.hasAttribute("type")&&y("button")},[s,t]),s}var we=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(we||{}),Me=(e=>(e[e.TogglePopover=0]="TogglePopover",e[e.ClosePopover=1]="ClosePopover",e[e.SetButton=2]="SetButton",e[e.SetButtonId=3]="SetButtonId",e[e.SetPanel=4]="SetPanel",e[e.SetPanelId=5]="SetPanelId",e))(Me||{});let Ce={0:e=>{let t={...e,popoverState:G(e.popoverState,{0:1,1:0})};return t.popoverState===0&&(t.__demoMode=!1),t},1(e){return e.popoverState===1?e:{...e,popoverState:1}},2(e,t){return e.button===t.button?e:{...e,button:t.button}},3(e,t){return e.buttonId===t.buttonId?e:{...e,buttonId:t.buttonId}},4(e,t){return e.panel===t.panel?e:{...e,panel:t.panel}},5(e,t){return e.panelId===t.panelId?e:{...e,panelId:t.panelId}}},ue=u.createContext(null);ue.displayName="PopoverContext";function Q(e){let t=u.useContext(ue);if(t===null){let s=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,Q),s}return t}let ae=u.createContext(null);ae.displayName="PopoverAPIContext";function se(e){let t=u.useContext(ae);if(t===null){let s=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,se),s}return t}let ie=u.createContext(null);ie.displayName="PopoverGroupContext";function be(){return u.useContext(ie)}let Z=u.createContext(null);Z.displayName="PopoverPanelContext";function Fe(){return u.useContext(Z)}function Oe(e,t){return G(t.type,Ce,e,t)}let ke="div";function Be(e,t){var s;let{__demoMode:y=!1,...x}=e,l=u.useRef(null),n=K(t,me(a=>{l.current=a})),S=u.useRef([]),m=u.useReducer(Oe,{__demoMode:y,popoverState:y?0:1,buttons:S,button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:u.createRef(),afterPanelSentinel:u.createRef()}),[{popoverState:g,button:c,buttonId:h,panel:o,panelId:O,beforePanelSentinel:P,afterPanelSentinel:p},d]=m,E=oe((s=l.current)!=null?s:c),F=u.useMemo(()=>{if(!c||!o)return!1;for(let V of document.querySelectorAll("body > *"))if(Number(V==null?void 0:V.contains(c))^Number(V==null?void 0:V.contains(o)))return!0;let a=le(),w=a.indexOf(c),Y=(w+a.length-1)%a.length,W=(w+1)%a.length,J=a[Y],Pe=a[W];return!o.contains(J)&&!o.contains(Pe)},[c,o]),M=ce(h),L=ce(O),k=u.useMemo(()=>({buttonId:M,panelId:L,close:()=>d({type:1})}),[M,L,d]),B=be(),i=B==null?void 0:B.registerPopover,I=$(()=>{var a;return(a=B==null?void 0:B.isFocusWithinPopoverGroup())!=null?a:(E==null?void 0:E.activeElement)&&((c==null?void 0:c.contains(E.activeElement))||(o==null?void 0:o.contains(E.activeElement)))});u.useEffect(()=>i==null?void 0:i(k),[i,k]);let[v,C]=ye(),r=Se({portals:v,defaultContainers:[c,o]});Ee(E==null?void 0:E.defaultView,"focus",a=>{var w,Y,W,J;a.target!==window&&a.target instanceof HTMLElement&&g===0&&(I()||c&&o&&(r.contains(a.target)||(Y=(w=P.current)==null?void 0:w.contains)!=null&&Y.call(w,a.target)||(J=(W=p.current)==null?void 0:W.contains)!=null&&J.call(W,a.target)||d({type:1})))},!0),ge(r.resolveContainers,(a,w)=>{d({type:1}),he(w,Ie.Loose)||(a.preventDefault(),c==null||c.focus())},g===0);let f=$(a=>{d({type:1});let w=(()=>a?a instanceof HTMLElement?a:"current"in a&&a.current instanceof HTMLElement?a.current:c:c)();w==null||w.focus()}),b=u.useMemo(()=>({close:f,isPortalled:F}),[f,F]),D=u.useMemo(()=>({open:g===0,close:f}),[g,f]),U={ref:n};return T.createElement(Z.Provider,{value:null},T.createElement(ue.Provider,{value:m},T.createElement(ae.Provider,{value:b},T.createElement($e,{value:G(g,{0:q.Open,1:q.Closed})},T.createElement(C,null,z({ourProps:U,theirProps:x,slot:D,defaultTag:ke,name:"Popover"}),T.createElement(r.MainTreeNode,null))))))}let De="button";function _e(e,t){let s=H(),{id:y=`headlessui-popover-button-${s}`,...x}=e,[l,n]=Q("Popover.Button"),{isPortalled:S}=se("Popover.Button"),m=u.useRef(null),g=`headlessui-focus-sentinel-${H()}`,c=be(),h=c==null?void 0:c.closeOthers,o=Fe()!==null;u.useEffect(()=>{if(!o)return n({type:3,buttonId:y}),()=>{n({type:3,buttonId:null})}},[o,y,n]);let[O]=u.useState(()=>Symbol()),P=K(m,t,o?null:r=>{if(r)l.buttons.current.push(O);else{let f=l.buttons.current.indexOf(O);f!==-1&&l.buttons.current.splice(f,1)}l.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),r&&n({type:2,button:r})}),p=K(m,t),d=oe(m),E=$(r=>{var f,b,D;if(o){if(l.popoverState===1)return;switch(r.key){case N.Space:case N.Enter:r.preventDefault(),(b=(f=r.target).click)==null||b.call(f),n({type:1}),(D=l.button)==null||D.focus();break}}else switch(r.key){case N.Space:case N.Enter:r.preventDefault(),r.stopPropagation(),l.popoverState===1&&(h==null||h(l.buttonId)),n({type:0});break;case N.Escape:if(l.popoverState!==0)return h==null?void 0:h(l.buttonId);if(!m.current||d!=null&&d.activeElement&&!m.current.contains(d.activeElement))return;r.preventDefault(),r.stopPropagation(),n({type:1});break}}),F=$(r=>{o||r.key===N.Space&&r.preventDefault()}),M=$(r=>{var f,b;fe(r.currentTarget)||e.disabled||(o?(n({type:1}),(f=l.button)==null||f.focus()):(r.preventDefault(),r.stopPropagation(),l.popoverState===1&&(h==null||h(l.buttonId)),n({type:0}),(b=l.button)==null||b.focus()))}),L=$(r=>{r.preventDefault(),r.stopPropagation()}),k=l.popoverState===0,B=u.useMemo(()=>({open:k}),[k]),i=xe(e,m),I=o?{ref:p,type:i,onKeyDown:E,onClick:M}:{ref:P,id:l.buttonId,type:i,"aria-expanded":e.disabled?void 0:l.popoverState===0,"aria-controls":l.panel?l.panelId:void 0,onKeyDown:E,onKeyUp:F,onClick:M,onMouseDown:L},v=de(),C=$(()=>{let r=l.panel;if(!r)return;function f(){G(v.current,{[R.Forwards]:()=>A(r,_.First),[R.Backwards]:()=>A(r,_.Last)})===re.Error&&A(le().filter(b=>b.dataset.headlessuiFocusGuard!=="true"),G(v.current,{[R.Forwards]:_.Next,[R.Backwards]:_.Previous}),{relativeTo:l.button})}f()});return T.createElement(T.Fragment,null,z({ourProps:I,theirProps:x,slot:B,defaultTag:De,name:"Popover.Button"}),k&&!o&&S&&T.createElement(te,{id:g,features:ne.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:C}))}let Re="div",Le=X.RenderStrategy|X.Static;function Ne(e,t){let s=H(),{id:y=`headlessui-popover-overlay-${s}`,...x}=e,[{popoverState:l},n]=Q("Popover.Overlay"),S=K(t),m=ve(),g=(()=>m!==null?(m&q.Open)===q.Open:l===0)(),c=$(o=>{if(fe(o.currentTarget))return o.preventDefault();n({type:1})}),h=u.useMemo(()=>({open:l===0}),[l]);return z({ourProps:{ref:S,id:y,"aria-hidden":!0,onClick:c},theirProps:x,slot:h,defaultTag:Re,features:Le,visible:g,name:"Popover.Overlay"})}let Ae="div",Ge=X.RenderStrategy|X.Static;function He(e,t){let s=H(),{id:y=`headlessui-popover-panel-${s}`,focus:x=!1,...l}=e,[n,S]=Q("Popover.Panel"),{close:m,isPortalled:g}=se("Popover.Panel"),c=`headlessui-focus-sentinel-before-${H()}`,h=`headlessui-focus-sentinel-after-${H()}`,o=u.useRef(null),O=K(o,t,i=>{S({type:4,panel:i})}),P=oe(o);ee(()=>(S({type:5,panelId:y}),()=>{S({type:5,panelId:null})}),[y,S]);let p=ve(),d=(()=>p!==null?(p&q.Open)===q.Open:n.popoverState===0)(),E=$(i=>{var I;switch(i.key){case N.Escape:if(n.popoverState!==0||!o.current||P!=null&&P.activeElement&&!o.current.contains(P.activeElement))return;i.preventDefault(),i.stopPropagation(),S({type:1}),(I=n.button)==null||I.focus();break}});u.useEffect(()=>{var i;e.static||n.popoverState===1&&((i=e.unmount)==null||i)&&S({type:4,panel:null})},[n.popoverState,e.unmount,e.static,S]),u.useEffect(()=>{if(n.__demoMode||!x||n.popoverState!==0||!o.current)return;let i=P==null?void 0:P.activeElement;o.current.contains(i)||A(o.current,_.First)},[n.__demoMode,x,o,n.popoverState]);let F=u.useMemo(()=>({open:n.popoverState===0,close:m}),[n,m]),M={ref:O,id:y,onKeyDown:E,onBlur:x&&n.popoverState===0?i=>{var I,v,C,r,f;let b=i.relatedTarget;b&&o.current&&((I=o.current)!=null&&I.contains(b)||(S({type:1}),((C=(v=n.beforePanelSentinel.current)==null?void 0:v.contains)!=null&&C.call(v,b)||(f=(r=n.afterPanelSentinel.current)==null?void 0:r.contains)!=null&&f.call(r,b))&&b.focus({preventScroll:!0})))}:void 0,tabIndex:-1},L=de(),k=$(()=>{let i=o.current;if(!i)return;function I(){G(L.current,{[R.Forwards]:()=>{var v;A(i,_.First)===re.Error&&((v=n.afterPanelSentinel.current)==null||v.focus())},[R.Backwards]:()=>{var v;(v=n.button)==null||v.focus({preventScroll:!0})}})}I()}),B=$(()=>{let i=o.current;if(!i)return;function I(){G(L.current,{[R.Forwards]:()=>{var v;if(!n.button)return;let C=le(),r=C.indexOf(n.button),f=C.slice(0,r+1),b=[...C.slice(r+1),...f];for(let D of b.slice())if(D.dataset.headlessuiFocusGuard==="true"||(v=n.panel)!=null&&v.contains(D)){let U=b.indexOf(D);U!==-1&&b.splice(U,1)}A(b,_.First,{sorted:!1})},[R.Backwards]:()=>{var v;A(i,_.Previous)===re.Error&&((v=n.button)==null||v.focus())}})}I()});return T.createElement(Z.Provider,{value:y},d&&g&&T.createElement(te,{id:c,ref:n.beforePanelSentinel,features:ne.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:k}),z({ourProps:M,theirProps:l,slot:F,defaultTag:Ae,features:Ge,visible:d,name:"Popover.Panel"}),d&&g&&T.createElement(te,{id:h,ref:n.afterPanelSentinel,features:ne.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:B}))}let Ke="div";function qe(e,t){let s=u.useRef(null),y=K(s,t),[x,l]=u.useState([]),n=$(P=>{l(p=>{let d=p.indexOf(P);if(d!==-1){let E=p.slice();return E.splice(d,1),E}return p})}),S=$(P=>(l(p=>[...p,P]),()=>n(P))),m=$(()=>{var P;let p=Te(s);if(!p)return!1;let d=p.activeElement;return(P=s.current)!=null&&P.contains(d)?!0:x.some(E=>{var F,M;return((F=p.getElementById(E.buttonId.current))==null?void 0:F.contains(d))||((M=p.getElementById(E.panelId.current))==null?void 0:M.contains(d))})}),g=$(P=>{for(let p of x)p.buttonId.current!==P&&p.close()}),c=u.useMemo(()=>({registerPopover:S,unregisterPopover:n,isFocusWithinPopoverGroup:m,closeOthers:g}),[S,n,m,g]),h=u.useMemo(()=>({}),[]),o=e,O={ref:y};return T.createElement(ie.Provider,{value:c},z({ourProps:O,theirProps:o,slot:h,defaultTag:Ke,name:"Popover.Group"}))}let We=j(Be),je=j(_e),ze=j(Ne),Ue=j(He),Ye=j(qe),Xe=Object.assign(We,{Button:je,Overlay:ze,Panel:Ue,Group:Ye});export{Xe as k,xe as s};
