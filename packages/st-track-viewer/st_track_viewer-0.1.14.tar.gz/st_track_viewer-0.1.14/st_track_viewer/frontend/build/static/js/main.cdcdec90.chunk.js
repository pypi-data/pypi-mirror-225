(this.webpackJsonpstreamlit_component_template=this.webpackJsonpstreamlit_component_template||[]).push([[0],{477:function(e,t,n){},478:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=478},731:function(e,t,n){},733:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(58),c=n.n(a),s=n(131),o=n(25),l=n(11),d=n(430),u=n(832),h=n(839),j=function(e){return e.UNKNOWN="Unknown",e.BICYCLE="Bicycle",e.PEDESTRIAN="Pedestrian",e.LIGHT_VEHICLE="Light vehicle",e.HEAVY_VEHICLE="Heavy vehicle",e}({}),f=Object.values(j);function b(e){return f.includes(e)}function m(e){switch(e){case j.UNKNOWN:return"green";case j.BICYCLE:return"purple";case j.PEDESTRIAN:return"red";case j.LIGHT_VEHICLE:return"cyan";case j.HEAVY_VEHICLE:return"pink"}}var g=200,p=150,O=n(35),x=n.n(O),v=n(192),y=n(37),k=n(48),w=n(13),C=n(7),T=n(8),M=n(4),S=n(5),L=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(M.a)(this,e),this._pos=void 0,this._pos=[t,n,r]}return Object(S.a)(e,[{key:"x",get:function(){return this._pos[0]},set:function(e){this._pos[0]=e}},{key:"y",get:function(){return this._pos[1]},set:function(e){this._pos[1]=e}},{key:"z",get:function(){return this._pos[2]},set:function(e){this._pos[2]=e}},{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y&&this.z===e.z}},{key:"distanceTo",value:function(e){return Math.sqrt(Math.pow(e.x-this.x,2)+Math.pow(e.y-this.y,2)+Math.pow(e.z-this.z,2))}}],[{key:"cross",value:function(t,n){return new e(t.y*n.z-t.z*n.y,t.z*n.x-t.x*n.z,t.x*n.y-t.y*n.x)}}]),e}(),N=function(e){Object(C.a)(n,e);var t=Object(T.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return Object(M.a)(this,n),(e=t.call(this,r,i,a))._angles=void 0,e._angles=[c,s,o],e}return Object(S.a)(n,[{key:"yaw",get:function(){return this._angles[0]},set:function(e){this._angles[0]=e}},{key:"pitch",get:function(){return this._angles[1]},set:function(e){this._angles[1]=e}},{key:"roll",get:function(){return this._angles[2]},set:function(e){this._angles[2]=e}},{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y&&this.z===e.z&&this.yaw===e.yaw&&this.pitch===e.pitch&&this.roll===e.roll}}]),n}(L);n(477);function E(){var e=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];return e[0][0]=1,e[1][1]=1,e[2][2]=1,e[3][3]=1,e}function I(e,t){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],r=0;r<4;r++)for(var i=0;i<4;i++)n[r][i]=e[r][0]*t[0][i]+e[r][1]*t[1][i]+e[r][2]*t[2][i]+e[r][3]*t[3][i];return n}function F(e,t){var n=new L;return n.x=e[0][0]*t.x+e[0][1]*t.y+e[0][2]*t.z+e[0][3],n.y=e[1][0]*t.x+e[1][1]*t.y+e[1][2]*t.z+e[1][3],n.z=e[2][0]*t.x+e[2][1]*t.y+e[2][2]*t.z+e[2][3],n}function R(e,t){var n=Math.cos(t),r=Math.sin(t),i=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];return i[0][0]=1,i[1][1]=n,i[1][2]=-r,i[2][1]=r,i[2][2]=n,i[3][3]=1,I(i,e)}function W(e,t){var n=Math.cos(t),r=Math.sin(t),i=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];return i[0][0]=n,i[0][2]=r,i[1][1]=1,i[2][0]=-r,i[2][2]=n,i[3][3]=1,I(i,e)}function H(e,t){var n=Math.cos(t),r=Math.sin(t),i=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];return i[0][0]=n,i[0][1]=-r,i[1][0]=r,i[1][1]=n,i[2][2]=1,i[3][3]=1,I(i,e)}function z(e,t,n,r){return e=R(e=W(e=H(e,t),n),r)}function D(e,t,n,r){var i=JSON.parse(JSON.stringify(e));return i[0][0]+=e[3][0]*t,i[0][1]+=e[3][1]*t,i[0][2]+=e[3][2]*t,i[0][3]+=e[3][3]*t,i[1][0]+=e[3][0]*n,i[1][1]+=e[3][1]*n,i[1][2]+=e[3][2]*n,i[1][3]+=e[3][3]*n,i[2][0]+=e[3][0]*r,i[2][1]+=e[3][1]*r,i[2][2]+=e[3][2]*r,i[2][3]+=e[3][3]*r,i}function _(e,t,n,r){var i=JSON.parse(JSON.stringify(e));return i[0][0]*=t,i[0][1]*=t,i[0][2]*=t,i[0][3]*=t,i[1][0]*=n,i[1][1]*=n,i[1][2]*=n,i[1][3]*=n,i[2][0]*=r,i[2][1]*=r,i[2][2]*=r,i[2][3]*=r,i}function V(e,t,n,r){return[(r=F(P(e,t,n),r)).x,r.y]}function P(e,t,n){var r=E();return r=D(r,-e.pos.x,-e.pos.y,-e.pos.z),r=D(r=_(r=z(r,-e.pos.yaw,-e.pos.pitch,-e.pos.roll),t/e.width,n/e.height,1),.5*t-.5,.5*n-.5,0)}var A=n(1),B=function(e){var t=e.WIDTH,n=e.HEIGHT,i=e.scale,a=e.tracks,c=e.ground,s=e.showId,o=e.filters;return Object(A.jsx)("svg",{width:t,height:n,style:{transform:"scale(".concat(i,")"),transformOrigin:"top left",overflow:"visible"},children:Object(r.useMemo)((function(){return a.map((function(e){var r=e.pathString(c,t,n,o.onlyConfirmed,o.markMeasurements,o.markEstimated),i=V(c,t,n,e.startPos),a=Object(l.a)(i,2),d=a[0],u=a[1],h=V(c,t,n,e.endPos),j=Object(l.a)(h,2),f=j[0],b=j[1];return Object(A.jsxs)("g",{children:[r.map((function(e,t){var n=Object(l.a)(e,2),r=n[0],i=n[1];return Object(A.jsx)("path",{d:r,stroke:i,fill:"none"},t)})),Object(A.jsx)("circle",{cx:d,cy:u,r:4,fill:"green",strokeWidth:"4"}),Object(A.jsx)("circle",{cx:f,cy:b,r:4,fill:"red",strokeWidth:"4"}),s&&Object(A.jsx)("text",{x:f,y:b,fill:"white",fontFamily:"sans-serif",fontSize:10,children:e.id})]},e.id)}))}),[a,c,s,n,t,o])})},Y=n(404),K=n.n(Y),U=n(828),G=n(223),J=n(844),q=n(845),X=n(829),Q=n(834),Z=function(e){var t=e.filters,n=e.onMarkMeasurements,r=e.onMarkEstimated,i=e.onMarkOnlyConfirmed,a=e.onMarkTrackId;return Object(A.jsx)(J.a,{sx:{margin:0,marginLeft:2},component:"fieldset",variant:"standard",children:Object(A.jsxs)(q.a,{row:!0,children:[Object(A.jsxs)(q.a,{children:[Object(A.jsx)(X.a,{control:Object(A.jsx)(Q.a,{checked:t.markMeasurements,onChange:n}),label:Object(A.jsx)(G.a,{fontSize:15,fontWeight:600,children:"Mark measurements"})}),Object(A.jsx)(X.a,{control:Object(A.jsx)(Q.a,{checked:t.markEstimated,onChange:r}),label:Object(A.jsx)(G.a,{fontSize:15,fontWeight:600,children:"Mark estimated"})})]}),Object(A.jsxs)(q.a,{children:[Object(A.jsx)(X.a,{control:Object(A.jsx)(Q.a,{checked:t.onlyConfirmed,onChange:i}),label:Object(A.jsx)(G.a,{fontSize:15,fontWeight:600,children:"Show only confirmed"})}),Object(A.jsx)(X.a,{control:Object(A.jsx)(Q.a,{checked:t.trackId,onChange:a}),label:Object(A.jsx)(G.a,{fontSize:15,fontWeight:600,children:"Show track id"})})]})]})})},$=n(846),ee=n(847),te=n(837),ne=n(826),re=n(851),ie=n(813),ae=function(){function e(t,n,r,i,a,c){Object(M.a)(this,e),this.id=void 0,this.startTime=void 0,this.endTime=void 0,this.timestamps=void 0,this.coordinates=void 0,this.speeds=void 0,this.estimated=void 0,this.types=void 0,this.presentTypes=void 0,this.startPos=void 0,this.endPos=void 0,this.id=t,this.timestamps=n,this.startTime=x()(n[0]),this.endTime=x()(n.at(-1)),this.coordinates=r[0].map((function(e,t){return new L(e,r[1][t],0)})),this.speeds=i,this.estimated=a.map((function(e){return 1===e})),this.types=c.map((function(e){return function(e){switch(e){case 0:default:return j.UNKNOWN;case 1:return j.BICYCLE;case 4:return j.PEDESTRIAN;case 18:return j.LIGHT_VEHICLE;case 34:return j.HEAVY_VEHICLE}}(e)})),this.startPos=this.coordinates[0],this.endPos=this.coordinates[this.coordinates.length-1],this.presentTypes=[];for(var s=0;s<this.types.length;s++){var o=this.types[s];if(this.presentTypes.includes(o)||this.presentTypes.push(o),this.presentTypes.length===f.length)break}}return Object(S.a)(e,[{key:"getEstimated",value:function(){var e=this;return this.coordinates.filter((function(t,n){return e.estimated[n]}))}},{key:"getConfirmed",value:function(){var e=this;return this.coordinates.filter((function(t,n){return!e.estimated[n]}))}},{key:"toGround",value:function(e,t,n){return this.coordinates.map((function(r){return V(e,t,n,r)}))}},{key:"length",value:function(){return this.startPos.distanceTo(this.endPos)}},{key:"speed",value:function(){return this.speeds.reduce((function(e,t){return e+t}),0)/this.speeds.length}},{key:"pathString",value:function(e,t,n,r,i,a){for(var c=this.toGround(e,t,n),s=[],o=0;o<c.length-1;o++){for(var d="M ".concat(c[o][0]," ").concat(c[o][1]),u=m(this.types[o]);o<c.length-1&&this.types[o]===this.types[o+1];){o++;var h=this.estimated[o],j=Object(l.a)(c[o],2),f=j[0],b=j[1];if(d+="L ".concat(c[o][0]," ").concat(c[o][1]," "),i&&!h||a&&h){var g=h?3:6,p=Object(l.a)(c[o-1],2),O=p[0],x=p[1],v=Math.sqrt(Math.pow(O-f,2)+Math.pow(x-b,2)),y=0===v?1:v,k=[(b-x)/y,(O-f)/y],w=.707,C=k[0]*w-k[1]*w,T=k[0]*w+k[1]*w;d+="L ".concat(f+C*g," ").concat(b+T*g," L ").concat(f," ").concat(b," L ").concat(f-T*g," ").concat(b+C*g," L ").concat(f," ").concat(b," ")}}o+1!==c.length&&(d+="L ".concat(c[o+1][0]," ").concat(c[o+1][1]," ")),s.push([d,u])}return s}}],[{key:"idCompare",value:function(e,t){return e.id-t.id}},{key:"lengthCompare",value:function(e,t){return e.length()-t.length()}},{key:"speedCompare",value:function(e,t){return e.speed()-t.speed()}},{key:"typeCompare",value:function(e,t){return e.presentTypes.length!==t.presentTypes.length?e.presentTypes.length-t.presentTypes.length:e.presentTypes.reduce((function(e,t){return e+f.indexOf(t)}),0)-t.presentTypes.reduce((function(e,t){return e+f.indexOf(t)}),0)}}]),e}(),ce=n(836),se=n(802),oe=n(803),le=n(804),de=function(e){var t=e.tracks,n=e.selectedTracks,r=e.onTrackSelect;return Object(A.jsxs)(A.Fragment,{children:[0!==t.length&&Object(A.jsxs)(ce.a,{children:[Object(A.jsx)(se.a,{sx:{visibility:"hidden"},children:Object(A.jsx)(Q.a,{edge:"start",tabIndex:-1,disableRipple:!0})}),Object(A.jsx)(G.a,{fontWeight:500,sx:{width:"25%"},children:"Id"}),Object(A.jsx)(G.a,{fontWeight:500,sx:{width:"25%"},children:"Length"}),Object(A.jsx)(G.a,{fontWeight:500,sx:{width:"25%"},children:"Speed"}),Object(A.jsx)(G.a,{fontWeight:500,sx:{width:"25%"},children:"Type"})]}),t.map((function(e){return Object(A.jsxs)(oe.a,{onClick:function(t){return r(t,e)},children:[Object(A.jsx)(se.a,{children:Object(A.jsx)(Q.a,{edge:"start",checked:n.has(e.id),tabIndex:-1,disableRipple:!0})}),Object(A.jsx)(le.a,{style:{width:"25%"},primary:e.id}),Object(A.jsx)(le.a,{style:{width:"25%"},primary:Math.round(1e4*(e.length()+Number.EPSILON))/1e4}),Object(A.jsx)(le.a,{style:{width:"25%"},primary:Math.round(1e4*(e.speed()+Number.EPSILON))/1e4}),Object(A.jsx)(le.a,{style:{width:"25%"},primary:e.presentTypes.reduce((function(e,t){return e+t+" "}),"")})]},e.id)}))]})},ue=function(e){var t=e.width,n=e.tracks,i=e.switchLeftLabel,a=e.switchRightLabel,c=e.selectedTracks,s=e.onSwitch,o=e.onTrackSelect,d=["Id","Length","Speed","Type"],u=Object(r.useState)(d[0]),h=Object(l.a)(u,2),j=h[0],f=h[1];return Object(A.jsx)("div",{style:{marginTop:10,width:t},children:Object(A.jsxs)($.a,{sx:{bgcolor:"background.paper",position:"relative",overflow:"auto",borderRadius:1,maxHeight:"100%"},dense:!0,subheader:Object(A.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginRight:20,marginLeft:20,minHeight:60},children:[Object(A.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(A.jsx)(G.a,{fontWeight:600,children:i}),Object(A.jsx)(ee.a,{onChange:s}),Object(A.jsx)(G.a,{fontWeight:600,children:a})]}),Object(A.jsxs)(J.a,{children:[Object(A.jsx)(te.a,{id:"demo-simple-select-label",children:Object(A.jsx)(G.a,{fontWeight:600,children:"Filter on"})}),Object(A.jsx)(ne.a,{sx:{height:40,width:100},labelId:"demo-simple-select-label",id:"demo-simple-select",value:j,label:Object(A.jsx)(G.a,{fontWeight:600,children:"Filter on"}),onChange:function(e){var t;t=e.target.value,d.includes(t)&&f(e.target.value)},children:d.map((function(e,t){return Object(A.jsx)(re.a,{value:e,children:e},t)}))})]})]}),component:"nav","aria-label":"tracks list",children:[Object(A.jsx)(ie.a,{sx:{borderBottomWidth:3}}),Object(A.jsx)(de,{tracks:function(e,t){return e.sort(function(e){switch(e){case"Id":default:return ae.idCompare;case"Length":return ae.lengthCompare;case"Type":return ae.typeCompare;case"Speed":return ae.speedCompare}}(t))}(n,j),selectedTracks:c,onTrackSelect:o})]})})},he=n(854),je=n(814),fe=n(815),be=n(203),me=n(81),ge=n(204),pe=n(165),Oe=n(213),xe=n(72),ve=function(e){var t=e.backgroundColor,n=e.children;return Object(A.jsx)("div",{className:"custom-tooltip",style:{zIndex:9999,borderRadius:5,backgroundColor:t,borderColor:"#FFFFFF",paddingLeft:10,paddingRight:10,border:"1px solid #FFF4F4"},children:n})},ye=function(e){for(var t=[],n=0;n<e;n++){var r=2*(e-n)/(e+1),i=(1-e+2*n)/(e+1);t.push([r,i])}return t},ke=function(e){var t=e.x,n=e.y,r=e.width,i=e.height,a=e.types;return void 0!==t&&void 0!==n&&void 0!==r&&void 0!==i?Object(A.jsxs)("svg",{width:r,height:i,x:t,y:n,children:[Object(A.jsx)("path",{d:"M 0 0 L 0 ".concat(i," L ").concat(r," ").concat(i," L ").concat(r," 0 z"),fill:m(a[0])}),1!==a.length?ye(a.length-1).map((function(e,t){var n=Object(l.a)(e,2),c=n[0],s=n[1];return Object(A.jsx)("path",{d:"M 0 ".concat(i*s," L ").concat(r*c," ").concat(i," L 0 ").concat(i," z"),fill:m(a[t+1])},t)})):null]}):null},we=function(e){return 0===e.length?"":e[0].startTime.toString()+e.length},Ce={top:0,right:20,left:0,bottom:20},Te=function(e){var t=e.tracks,n=e.height,i=e.binSize,a=e.valueLabel,c=function(e,t,n){return Object(r.useMemo)((function(){for(var r=e.reduce((function(e,t,r){var i=n(t);return[Math.min(e[0],i),Math.max(e[1],i)]}),[Number.MAX_VALUE,0]),i=Object(l.a)(r,2),a=i[0],c=(i[1]-a)/t,s=[],o=[],d=1;d<=t;d++){var u=5e-5,h=a+(d-1)*c-u,j=a+d*c+u;s.push({min:h,max:j,ids:[]})}return e.forEach((function(e){var t=n(e),r=e.presentTypes.toString(),i=s.findIndex((function(e){return t>=e.min&&t<=e.max}));s[i].ids.push(e.id),Object.keys(s[i]).includes(r)?s[i][r]+=1:(s[i][r]=1,-1===o.findIndex((function(t){return n=t,r=e.presentTypes,n.length===r.length&&n.every((function(e){return r.includes(e)}));var n,r}))&&o.push(e.presentTypes))})),[s,o]}),[we(e),t])}(t,i,e.calcValue),s=Object(l.a)(c,2),o=s[0],d=s[1],u=Object(xe.a)().palette;return Object(A.jsx)(he.a,{width:"100%",height:n,children:Object(A.jsxs)(je.a,{data:o,margin:Ce,children:[Object(A.jsx)(fe.a,{}),Object(A.jsx)(be.a,{dataKey:"min",type:"number",domain:[function(e){return e-3<0?0:e-3},function(e){return e+3}],fontFamily:"sans-serif",tickFormatter:function(e){return String(Math.round(100*e)/100)},children:Object(A.jsx)(me.a,{fontFamily:"sans-serif",value:"Number of samples",offset:-8,position:"insideBottom"})}),Object(A.jsx)(ge.a,{type:"number",fontFamily:"sans-serif"}),Object(A.jsx)(pe.a,{content:function(e){var t=e.payload;return e.active&&t&&t.length?Object(A.jsxs)(ve,{backgroundColor:u.background.default,children:[Object(A.jsx)("p",{className:"nbr-label",style:{fontFamily:"sans-serif"},children:Object(A.jsxs)("small",{children:["".concat(a,": ").concat(Math.round(100*Number(t[0].payload.min))/100," - ").concat(Math.round(100*Number(t[0].payload.max))/100)," "]})}),t.map((function(e,t){return void 0!==e.dataKey?Object(A.jsx)("p",{className:"nbr-label",style:{fontFamily:"sans-serif"},children:Object(A.jsx)("small",{children:"Types and entries: ".concat(e.dataKey,", ").concat(e.payload[e.dataKey])})},t+1):null}))]}):null}}),d.map((function(e,t){return Object(A.jsx)(Oe.a,{stackId:"a",dataKey:e.toString(),shape:Object(A.jsx)(ke,{types:e})},t)}))]})})},Me=function(e){var t=e.tracks,n=e.height,r=e.binSize;return Object(A.jsx)(Te,{valueLabel:"Length",tracks:t,height:n,binSize:r,calcValue:function(e){return Math.round(100*e.length())/100}})},Se=n(271),Le=n.n(Se),Ne=(n(731),function(e){var t=e.collapsibleClassName,n=void 0===t?"collapsible-card":t,i=e.headerClassName,a=void 0===i?"collapsible-header":i,c=e.titleClassName,s=void 0===c?"title-text":c,o=e.contentClassName,d=void 0===o?"collapsible-content":o,u=e.contentContainerClassName,h=void 0===u?"collapsible-content-padding":u,j=e.isOpen,f=e.handleFilterOpening,b=e.children,m=e.header,g=Object(r.useState)(j?void 0:0),p=Object(l.a)(g,2),O=p[0],x=p[1],v=Object(xe.a)().palette,y=Object(r.useRef)(null);return Object(r.useEffect)((function(){if(O&&j&&y.current){var e=new ResizeObserver((function(e){x(e[0].contentRect.height)}));return e.observe(y.current),function(){e.disconnect()}}}),[O,j]),Object(r.useEffect)((function(){var e;x(j?null===(e=y.current)||void 0===e?void 0:e.getBoundingClientRect().height:0)}),[j]),Object(A.jsx)(A.Fragment,{children:Object(A.jsxs)("div",{className:n,style:{borderRadius:5,backgroundColor:v.background.default},children:[Object(A.jsxs)("div",{className:a,onClick:f,style:{borderRadius:5,backgroundColor:v.background.default},children:[Object(A.jsx)("div",{className:s,children:m}),j?Object(A.jsx)(Le.a,{sx:{transform:"rotate(180deg)",transitionDuration:0}}):Object(A.jsx)(Le.a,{})]}),Object(A.jsx)("div",{className:d,style:{height:O},children:Object(A.jsx)("div",{ref:y,children:Object(A.jsx)("div",{className:h,children:j?b:Object(A.jsx)(A.Fragment,{})})})})]})})}),Ee=function(e){var t=e.tracks,n=e.height,r=e.binSize;return Object(A.jsx)(Te,{valueLabel:"Samples",tracks:t,height:n,binSize:r,calcValue:function(e){return e.coordinates.length}})},Ie=n(838);var Fe=function(e){var t=e.tracks,n=e.height,i=e.minHeight,a=e.maxHeight,c=e.isOpen,s=e.handleFilterOpening,o=Object(r.useState)(30),d=Object(l.a)(o,2),u=d[0],h=d[1],j=Object(r.useState)(30),f=Object(l.a)(j,2),b=f[0],m=f[1],g=function(e,t,n){return e<t?t:e>n?n:e}(n,i,a),O=function(e,t){var n=Number(e.target.value);isNaN(n)||t(n)};return Object(A.jsxs)(Ne,{isOpen:c,handleFilterOpening:s,header:"Show diagrams",children:[Object(A.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignContent:"top",marginBottom:10},children:[Object(A.jsx)("h5",{style:{fontFamily:"sans-serif",color:"#FFFFFF",marginTop:0,justifyContent:"space-between",alignContent:"top"},children:"Length histogram"}),Object(A.jsx)(Ie.a,{size:"small",variant:"standard",label:Object(A.jsx)(G.a,{fontWeight:600,children:"Number of bins"}),id:"outlined-start-adornment",sx:{width:p,backgroundColor:"background.default",borderRadius:1,margin:0},error:u<2,helperText:u<2?"Minimum bin size is ".concat(2):"",value:u,onChange:function(e){return O(e,h)}})]}),Object(A.jsx)(Me,{height:.5*g,binSize:u<2?2:u,tracks:t}),Object(A.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignContent:"top",marginBottom:10},children:[Object(A.jsx)("h5",{style:{fontFamily:"sans-serif",color:"#FFFFFF",marginTop:0},children:"Samples histogram"}),Object(A.jsx)(Ie.a,{size:"small",variant:"standard",label:Object(A.jsx)(G.a,{fontWeight:600,children:"Number of bins"}),id:"outlined-start-adornment",sx:{width:p,backgroundColor:"background.default",borderRadius:1,margin:0},value:b,error:b<2,helperText:b<2?"Minimum bin size is ".concat(2):"",onChange:function(e){return O(e,m)}})]}),Object(A.jsx)(Ee,{height:.5*g,tracks:t,binSize:b<2?2:b})]})},Re=n(6),We=n(817),He=n(424),ze=function(e){if(0===e.length)return[];var t=x()(e[0].timestamps[0]);return e.reduce((function(e,n){for(var r,i=[],a=n.speeds.length,c=0;c<a-1;c++){var s,o,l="".concat(n.id,":").concat(n.types[c]);if(i.push((s={},Object(Re.a)(s,l,n.speeds[c]),Object(Re.a)(s,"time",x()(n.timestamps[c]).diff(t)),Object(Re.a)(s,"speed",n.speeds[c]),Object(Re.a)(s,"type",n.types[c]),s)),n.types[c]!==n.types[c+1])i.push((o={},Object(Re.a)(o,l,n.speeds[c+1]),Object(Re.a)(o,"time",x()(n.timestamps[c+1]).diff(t)),Object(Re.a)(o,"speed",n.speeds[c+1]),Object(Re.a)(o,"type",n.types[c]),o))}var d="".concat(n.id,":").concat(n.types[a-1]);return i.push((r={},Object(Re.a)(r,d,n.speeds[a-1]),Object(Re.a)(r,"time",x()(n.timestamps[a-1]).diff(t)),Object(Re.a)(r,"speed",n.speeds[a-1]),Object(Re.a)(r,"type",n.types[a-1]),r)),e=e.concat(i)}),[])},De=function(e){return e.reduce((function(e,t,n){for(var r,i=x()(t.startTime),a=[],c=t.speeds.length,s=0;s<c-1;s++){var o,l,d="".concat(t.id,":").concat(t.types[s]);if(a.push((o={},Object(Re.a)(o,d,t.speeds[s]),Object(Re.a)(o,"time",x()(t.timestamps[s]).diff(i)),Object(Re.a)(o,"speed",t.speeds[s]),Object(Re.a)(o,"type",t.types[s]),o)),t.types[s]!==t.types[s+1])a.push((l={},Object(Re.a)(l,d,t.speeds[s+1]),Object(Re.a)(l,"time",x()(t.timestamps[s+1]).diff(i)),Object(Re.a)(l,"speed",t.speeds[s+1]),Object(Re.a)(l,"type",t.types[s]),l))}var u="".concat(t.id,":").concat(t.types[c-1]);return a.push((r={},Object(Re.a)(r,u,t.speeds[c-1]),Object(Re.a)(r,"time",x()(t.timestamps[c-1]).diff(i)),Object(Re.a)(r,"speed",t.speeds[c-1]),Object(Re.a)(r,"type",t.types[c-1]),r)),e=e.concat(a)}),[])},_e=function(e){return e.reduce((function(e,t){for(var n,r=[],i=t.speeds.length,a=0;a<i-1;a++){var c,s,o="".concat(t.id,":").concat(t.types[a]);if(r.push((c={},Object(Re.a)(c,o,t.speeds[a]),Object(Re.a)(c,"time",t.startPos.distanceTo(t.coordinates[a])),Object(Re.a)(c,"speed",t.speeds[a]),Object(Re.a)(c,"type",t.types[a]),c)),t.types[a]!==t.types[a+1])r.push((s={},Object(Re.a)(s,o,t.speeds[a+1]),Object(Re.a)(s,"time",t.startPos.distanceTo(t.coordinates[a+1])),Object(Re.a)(s,"speed",t.speeds[a+1]),Object(Re.a)(s,"type",t.types[a]),s))}var l="".concat(t.id,":").concat(t.types[i-1]);return r.push((n={},Object(Re.a)(n,l,t.speeds[i-1]),Object(Re.a)(n,"time",t.startPos.distanceTo(t.coordinates[i-1])),Object(Re.a)(n,"speed",t.speeds[i-1]),Object(Re.a)(n,"type",t.types[i-1]),n)),e=e.concat(r)}),[])},Ve=function(e){var t=e.tracks,n=e.height,i=e.plotOn,a=Object(r.useRef)(null),c=Object(r.useRef)(null),s=Object(r.useRef)(null),o=Object(r.useRef)([0,1]),d=function(e,t){return Object(r.useMemo)((function(){switch(t){case"Absolute time":return ze(e);case"Relative time":return De(e);case"Distance from start":return _e(e)}}),[we(e),t])}(t,i),u=d.reduce((function(e,t){return e[0]=Math.min(e[0],t.time),e[1]=Math.max(e[1],t.time),e}),[Number.MAX_VALUE,0]),h=Object(l.a)(u,2),j=h[0],f=h[1],b=Object(xe.a)().palette,g=function(e,t){return Math.sqrt(Math.pow((t.time-e[0])/(f-j),2)+Math.pow((t.speed-e[1])/(o.current[1]-o.current[0]),2))};return Object(A.jsx)("div",{ref:a,children:Object(A.jsx)(he.a,{width:"100%",height:n,children:Object(A.jsxs)(We.a,{data:d,onMouseMove:function(e,t){if(c.current=function(e){if(!a.current)return null;var t=a.current.getBoundingClientRect(),n=(e.nativeEvent.offsetX-67)/(t.width-67-5),r=(e.nativeEvent.offsetY-5)/(t.height-5-34),i=f-j,c=o.current[1]-r*(o.current[1]-o.current[0]);return[j+n*i,c]}(t),c.current){var n=function(e,t){for(var n=null,r=t,i=0;i<d.length;i++){var a=g(e,d[i]);a<r&&(r=a,n=d[i])}return null===n?null:n}(c.current,30);s.current=n||s.current}},children:[Object(A.jsx)(fe.a,{}),Object(A.jsx)(be.a,{dataKey:"time",type:"number",domain:["dataMin","dataMax"],tickFormatter:function(e){return function(e,t,n){switch(t){case"Absolute time":return x.a.isDayjs(n)?0===e?n.format("HH:mm:ss"):n.add(e,"milliseconds").format("HH:mm:ss"):String(e);case"Relative time":return String(e/1e3)+" s";case"Distance from start":return String(e)+" m"}}(e,i,0!==t.length?t[0].startTime:void 0)}}),Object(A.jsx)(ge.a,{domain:function(e){var t=Object(l.a)(e,2),n=(t[0],t[1]);return o.current=[0,n+2],[0,Math.round(100*(n+2))/100]},children:Object(A.jsx)(me.a,{fontFamily:"sans-serif",value:"km/h",position:"insideLeft",angle:-90})}),Object(A.jsx)(pe.a,{cursor:!1,content:function(e){var n=e.active;e.payload,e.label;if(n&&s.current){var r=s.current;return Object(A.jsxs)(ve,{backgroundColor:b.background.default,children:[Object(A.jsx)("p",{className:"nbr-label",style:{fontFamily:"sans-serif"},children:Object(A.jsx)("small",{children:"Id: ".concat(Object.keys(r)[0].split(":")[0])})}),Object(A.jsx)("p",{className:"lengt-label",style:{fontFamily:"sans-serif"},children:Object(A.jsx)("small",{children:"Speed: ".concat(Math.round(100*r.speed)/100)})}),Object(A.jsx)("p",{className:"lengt-label",style:{fontFamily:"sans-serif"},children:Object(A.jsx)("small",{children:Pe(r.time,i,0!==t.length?t[0].startTime:void 0)})})]})}return null}}),t.map((function(e,t){return e.presentTypes.map((function(t){return Object(A.jsx)(He.a,{type:"monotone",dataKey:"".concat(e.id,":").concat(t),stroke:m(t),dot:{r:0},activeDot:!1},"".concat(e.id,":").concat(t))}))}))]})})})},Pe=function(e,t,n){switch(t){case"Absolute time":return x.a.isDayjs(n)?0===e?"Time: "+n.format("HH:mm:ss"):"Time: "+n.add(e,"milliseconds").format("HH:mm:ss"):"Time: "+String(e);case"Relative time":return"Time: "+String(Math.round(100*e)/1e5)+" s";case"Distance from start":return"Distance: "+String(Math.round(100*e)/100)+" m"}},Ae=["Relative time","Absolute time","Distance from start"],Be=function(e){var t=e.tracks,n=e.height,i=e.isOpen,a=e.handleFilterOpening,c=Object(r.useState)(Ae[0]),s=Object(l.a)(c,2),o=s[0],d=s[1];return Object(A.jsx)("div",{style:{height:n,width:"100%",marginTop:10,marginLeft:10},children:Object(A.jsxs)(Ne,{isOpen:i,handleFilterOpening:a,header:"Speed",children:[Object(A.jsxs)(J.a,{sx:{marginBottom:2},children:[Object(A.jsx)(te.a,{id:"demo-simple-select-label",children:Object(A.jsx)(G.a,{fontWeight:600,children:"Plot on"})}),Object(A.jsx)(ne.a,{sx:{height:40,width:200},labelId:"demo-simple-select-label",id:"demo-simple-select",value:o,label:Object(A.jsx)(G.a,{fontWeight:600,children:"Plot on"}),onChange:function(e){var t;t=e.target.value,Ae.includes(t)&&d(e.target.value)},children:Ae.map((function(e,t){return Object(A.jsx)(re.a,{value:e,children:e},t)}))})]}),Object(A.jsx)(Ve,{tracks:t,height:n,plotOn:o})]})})},Ye=function(e){var t=e.label,n=e.plotterWidth,i=e.image,a=e.imageWidth,c=e.imageHeight,s=e.tracks,d=e.ground,u=Object(r.useState)(Math.round(100*(n/a+Number.EPSILON))/100*.66),j=Object(l.a)(u,2),f=j[0],b=j[1],m=c*Math.round(100*(n/a+Number.EPSILON))/100*.7,g=Object(r.useState)({markMeasurements:!1,markEstimated:!1,onlyConfirmed:!1,trackId:!1,showLines:!1,filterSelected:!1}),p=Object(l.a)(g,2),O=p[0],x=p[1],v=Object(r.useState)(new Set),y=Object(l.a)(v,2),k=y[0],C=y[1],T=Object(r.useState)(!0),M=Object(l.a)(T,2),S=M[0],L=M[1],N=Object(r.useState)(!1),E=Object(l.a)(N,2),I=E[0],F=E[1],R=Object(r.useState)(!1),W=Object(l.a)(R,2),H=W[0],z=W[1],D=Object(r.useRef)(!1),_=function(){return s.filter((function(e){return O.filterSelected===k.has(e.id)}))},V=Object(r.useCallback)((function(e){console.log("Keydown:",e.key),D.current&&("+"===e.key?b((function(e){return e+.1})):"-"===e.key&&b((function(e){return e-.1})))}),[D]);return Object(r.useEffect)((function(){return window.addEventListener("keydown",V),function(){window.removeEventListener("keydown",V)}}),[V]),Object(A.jsxs)("div",{style:{width:n},onMouseEnter:function(){D.current=!0},onMouseLeave:function(){D.current=!1},children:[Object(A.jsxs)("div",{children:[Object(A.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:10},children:[Object(A.jsxs)(h.a,{onClick:function(){return L((function(e){return!e}))},sx:{marginRight:1},variant:"text",children:["Version ",t]}),S&&Object(A.jsx)(U.a,{value:f,"aria-label":"Default",valueLabelDisplay:"auto",onChange:function(e,t){"number"===typeof t&&b(t)},min:0,max:4,step:.01,color:"primary",className:"slider",style:{margin:0,width:"66%",maxWidth:1060}})]}),S&&Object(A.jsx)(Z,{filters:O,onMarkMeasurements:function(e){x((function(t){return Object(o.a)(Object(o.a)({},t),{},{markMeasurements:e.target.checked})}))},onMarkEstimated:function(e){x((function(t){return Object(o.a)(Object(o.a)({},t),{},{markEstimated:e.target.checked})}))},onMarkOnlyConfirmed:function(e){x((function(t){return Object(o.a)(Object(o.a)({},t),{},{onlyConfirmed:e.target.checked})}))},onMarkTrackId:function(e){x((function(t){return Object(o.a)(Object(o.a)({},t),{},{trackId:e.target.checked})}))}})]}),Object(A.jsxs)("div",{style:{overflow:"hidden",height:c*f,minHeight:.7*m,maxHeight:m,display:"flex",flexDirection:"row"},children:[Object(A.jsx)("div",{style:{width:"66.6%",overflow:"hidden",overflowY:"auto"},children:Object(A.jsx)(K.a,{children:Object(A.jsx)("div",{className:"image-container",style:{width:a*f,height:c*f,backgroundImage:"url(".concat(i,")")},children:Object(A.jsx)(B,{tracks:_(),WIDTH:a,HEIGHT:c,scale:f,showId:O.trackId,ground:d,filters:O})})})}),Object(A.jsxs)("div",{style:{width:"33.3%",marginLeft:10},children:[Object(A.jsxs)(G.a,{fontWeight:600,sx:{marginBottom:1},children:["Number of tracks: ",s.length]}),0!==s.length?Object(A.jsx)(Fe,{isOpen:I,handleFilterOpening:function(){F((function(e){return!e}))},height:c*f-220,minHeight:.7*m-220,maxHeight:m-220,tracks:_()}):null]})]}),Object(A.jsxs)("div",{style:{display:"flex",flexDirection:"row",height:.7*m+150},children:[Object(A.jsx)(ue,{width:.5*n,tracks:Object(w.a)(s),switchLeftLabel:"Hide",switchRightLabel:"Show",selectedTracks:k,onSwitch:function(e){x((function(t){return Object(o.a)(Object(o.a)({},t),{},{filterSelected:e.target.checked})}))},onTrackSelect:function(e,t){k.has(t.id)?C((function(e){return e.delete(t.id),new Set(e)})):C((function(e){return e.add(t.id),new Set(e)}))}}),Object(A.jsx)(Be,{isOpen:H,handleFilterOpening:function(){z((function(e){return!e}))},tracks:_(),height:.7*m})]})]})},Ke=function(e){var t=e.fromTime,n=e.toTime,r=e.showType,i=e.showVersions,a=e.filterLength,c=Object(s.useRenderData)(),o=c.args.images,l=c.args.shapes,d=c.args.grounds,u=c.args.names,h=d.map((function(e){return{pos:Object(k.a)(N,Object(w.a)(e[0])),height:e[1],width:e[2]}})),j=function(e,t,n){return e.isAfter(t)&&e.isBefore(n)},f=c.args.tracks.map((function(e){return e.map((function(e){return Object(k.a)(ae,Object(w.a)(e))})).filter((function(e){return function(e,t,n,r,i){if(!j(e.startTime,t,n)&&!j(e.endTime,t,n))return!1;var a,c=Object(y.a)(e.presentTypes);try{for(c.s();!(a=c.n()).done;){var s=a.value;if(!r.includes(s))return!1}}catch(o){c.e(o)}finally{c.f()}return!i.filter||!(e.length()<i.minLength||e.length()>i.maxLength)}(e,t,n,r,a)}))})),b=i.length<=1?1:i.length%3===0?3:i.length%2===0?2:3;return Object(A.jsxs)("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap"},children:[f.map((function(e,t){return-1===i.indexOf(u[t])?null:Object(A.jsx)("div",{style:{margin:5},children:Object(A.jsx)(Ye,{image:o[t],plotterWidth:(window.innerWidth-20*b)/b,imageHeight:l[t][0],imageWidth:l[t][1],tracks:e,label:u[t],ground:h[t]})},t)})),Object(A.jsx)("div",{style:{height:1e4}})]})},Ue=n(425),Ge=n(824),Je=n(825),qe=n(818),Xe=function(e){var t=e.data,n=e.changeDate,r=e.changeTime,i=e.changeIntervalMin,a=e.changeIntervalSec;return Object(A.jsxs)(Ue.a,{dateAdapter:qe.a,children:[Object(A.jsx)(Ge.a,{label:Object(A.jsx)(G.a,{fontWeight:600,children:"Date"}),format:"YYYY-MM-DD",value:t.date,onChange:n,sx:{backgroundColor:"background.default",borderRadius:1,marginRight:2,width:g}}),Object(A.jsx)(Je.a,{label:Object(A.jsx)(G.a,{fontWeight:600,children:"From time"}),value:t.fromTime,onChange:r,ampm:!1,sx:{backgroundColor:"background.default",borderRadius:1,marginRight:2,width:g}}),Object(A.jsx)(Ie.a,{label:Object(A.jsx)(G.a,{fontWeight:600,children:"Interval in minutes"}),id:"outlined-start-adornment",sx:{width:p,backgroundColor:"background.default",borderRadius:1,marginRight:2},value:t.intervalMin,onChange:i}),Object(A.jsx)(Ie.a,{label:Object(A.jsx)(G.a,{fontWeight:600,children:"Interval in seconds"}),id:"outlined-start-adornment",sx:{width:p,backgroundColor:"background.default",borderRadius:1,margin:0},value:t.intervalSec,onChange:a})]})},Qe=function(e){var t=e.data,n=e.checkFilterBox,r=e.changeMinLength,i=e.changeMaxLength;return Object(A.jsxs)("div",{children:[Object(A.jsx)(X.a,{control:Object(A.jsx)(Q.a,{checked:t.filterLength.filter,onChange:n}),label:Object(A.jsx)(G.a,{fontWeight:600,children:"Filter length"}),style:{margin:0,marginTop:10,fontWeight:500}}),t.filterLength.filter&&Object(A.jsxs)("div",{style:{marginTop:10},children:[Object(A.jsx)(Ie.a,{label:Object(A.jsx)(G.a,{fontWeight:600,children:"Min length"}),id:"outlined-start-adornment",sx:{m:1,width:p,backgroundColor:"background.default",borderRadius:1,margin:0,marginRight:2},value:t.filterLength.minLength,onChange:r}),Object(A.jsx)(Ie.a,{label:Object(A.jsx)(G.a,{fontWeight:600,children:"Max length"}),id:"outlined-start-adornment",sx:{m:1,width:p,backgroundColor:"background.default",borderRadius:1,margin:0,marginRight:2},value:t.filterLength.maxLength,onChange:i})]})]})},Ze=n(840),$e=function(e){var t=e.title,n=e.value,r=e.labels,i=e.checked,a=e.handleChange,c={PaperProps:{style:{maxHeight:224,width:250}}};return Object(A.jsxs)(J.a,{sx:{m:1,width:g,margin:0,marginLeft:2},children:[Object(A.jsx)(te.a,{id:"demo-multiple-name-label",children:Object(A.jsx)(G.a,{fontWeight:600,children:t})}),Object(A.jsx)(ne.a,{labelId:"demo-multiple-name-label",id:"demo-multiple-name",multiple:!0,value:n,onChange:a,input:Object(A.jsx)(Ze.a,{label:t}),renderValue:function(e){return e.join(", ")},MenuProps:c,sx:{backgroundColor:"background.default"},children:r.map((function(e,t){return Object(A.jsxs)(re.a,{value:e,children:[Object(A.jsx)(Q.a,{checked:i(e)}),Object(A.jsx)(le.a,{primary:e})]},t)}))})]})},et=function(){var e=Object(s.useRenderData)(),t=e.args.names,n=e.args.data,i=x()(n.date),a={date:i,fromTime:i,intervalMin:n.min,intervalSec:n.sec,showType:n.types,showVersions:n.versions,filterLength:n.filter},c=Object(r.useState)(a),j=Object(l.a)(c,2),m=j[0],g=j[1],p=e.theme,O=Object(d.a)({palette:{primary:{main:null===p||void 0===p?void 0:p.primaryColor},common:{black:null===p||void 0===p?void 0:p.base},text:{primary:null===p||void 0===p?void 0:p.textColor,secondary:null===p||void 0===p?void 0:p.textColor},action:{active:"#fff"},background:{default:null===p||void 0===p?void 0:p.secondaryBackgroundColor,paper:null===p||void 0===p?void 0:p.secondaryBackgroundColor}}});Object(r.useEffect)((function(){m.date.isValid()&&v.Streamlit.setComponentValue({date:m.date.format(),min:m.intervalMin,sec:m.intervalSec,versions:m.showVersions,types:m.showType,filter:m.filterLength})}),[m.date]);var y=function(e){x.a.isDayjs(e)&&g((function(t){return Math.abs(t.date.diff(e))>=36e5&&(t.date=e),t.fromTime=e,Object(o.a)({},t)}))},k=function(e){y(e.fromTime.add(e.intervalMin,"minutes").add(e.intervalSec,"seconds"))},w=function(e){y(e.fromTime.subtract(e.intervalMin,"minutes").subtract(e.intervalSec,"seconds"))},C=Object(r.useCallback)((function(e){"ArrowRight"===e.key?k(m):"ArrowLeft"===e.key&&w(m)}),[m]);return Object(r.useEffect)((function(){return window.addEventListener("keydown",C),function(){window.removeEventListener("keydown",C)}}),[C]),Object(A.jsx)(u.a,{theme:O,children:Object(A.jsxs)("div",{style:{marginTop:30},children:[Object(A.jsx)(Xe,{data:m,changeDate:function(e){x.a.isDayjs(e)&&g((function(t){return t.date=e,Object(o.a)({},t)}))},changeTime:y,changeIntervalMin:function(e){var t=Number(e.target.value);isNaN(t)||g((function(e){return e.intervalMin=t,Object(o.a)({},e)}))},changeIntervalSec:function(e){var t=Number(e.target.value);isNaN(t)||g((function(e){return e.intervalSec=t,Object(o.a)({},e)}))}}),Object(A.jsx)($e,{title:"Show versions",value:m.showVersions,labels:t,checked:function(e){return-1!==m.showVersions.indexOf(e)},handleChange:function(e){var n=e.target.value;g((function(e){return e.showVersions="string"===typeof n?n.split(""):n.sort((function(e,n){return t.indexOf(e)-t.indexOf(n)})),Object(o.a)({},e)}))}}),Object(A.jsx)($e,{title:"Show types",value:m.showType,labels:f,checked:function(e){return b(e)&&-1!==m.showType.indexOf(e)},handleChange:function(e){var t=e.target.value;g((function(e){return e.showType="string"===typeof t?function(e){return b(e)?[e]:[]}(t):t,Object(o.a)({},e)}))}}),Object(A.jsx)(Qe,{data:m,checkFilterBox:function(e){g((function(t){return t.filterLength.filter=e.target.checked,Object(o.a)({},t)}))},changeMinLength:function(e){var t=Number(e.target.value);isNaN(t)||g((function(e){return e.filterLength.minLength=t,Object(o.a)({},e)}))},changeMaxLength:function(e){var t=Number(e.target.value);isNaN(t)||g((function(e){return e.filterLength.maxLength=t,Object(o.a)({},e)}))}}),Object(A.jsxs)("div",{style:{margin:0,marginTop:10},children:[Object(A.jsx)(h.a,{sx:{marginRight:2,backgroundColor:"background.default"},onClick:function(){return w(m)},children:"<"}),Object(A.jsx)(h.a,{sx:{marginRight:2,backgroundColor:"background.default"},onClick:function(){return k(m)},children:">"})]}),Object(A.jsx)(Ke,{fromTime:m.fromTime,toTime:m.fromTime.add(m.intervalMin,"minutes").add(m.intervalSec,"seconds"),showType:m.showType,showVersions:m.showVersions,filterLength:m.filterLength})]})})};console.warn=function(){},c.a.render(Object(A.jsx)(i.a.StrictMode,{children:Object(A.jsx)(s.StreamlitProvider,{children:Object(A.jsx)(et,{})})}),document.getElementById("root"))}},[[733,1,2]]]);
//# sourceMappingURL=main.cdcdec90.chunk.js.map