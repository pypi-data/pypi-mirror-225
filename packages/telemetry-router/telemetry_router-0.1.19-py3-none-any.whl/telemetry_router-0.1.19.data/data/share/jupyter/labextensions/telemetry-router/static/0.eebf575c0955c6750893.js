"use strict";(self.webpackChunktelemetry_router=self.webpackChunktelemetry_router||[]).push([[0],[(e,o,n)=>{n.r(o),n.d(o,{ITelemetryRouter:()=>v,TelemetryRouter:()=>h,default:()=>k});var s=n(930),t=n(519),i=n(380);async function r(e="",o={}){const n=i.ServerConnection.makeSettings(),s=t.URLExt.join(n.baseUrl,"telemetry-router",e);let r;try{r=await i.ServerConnection.makeRequest(s,o,n)}catch(e){throw new i.ServerConnection.NetworkError(e)}let l=await r.text();if(l.length>0)try{l=JSON.parse(l)}catch(e){console.log("Not a JSON response body.",r)}if(!r.ok)throw new i.ServerConnection.ResponseError(r,l.message||l);return l}class l{}l.id="BaseLogger";class a extends l{consume(e){console.log("ConsoleLogger",e)}}a.id="ConsoleLogger";class c extends l{async consume(e){const o={request:e,response:await r("mongo",{method:"POST",body:JSON.stringify(e)})};console.log("MongoDBLogger",o)}}c.id="MongoDBLogger";class d extends l{async consume(e){const o={request:e,response:await r("s3",{method:"POST",body:JSON.stringify(e)})};console.log("S3Logger",o)}}d.id="S3Logger";const u=[a,c,d],g="telemetry-router:plugin",v=new s.Token(g);class h{async loadNotebookPanel(e){this.notebookPanel=e,this.workspaceID=await r("env")}publishEvent(e,o){var n,s,t,i,r,l,a;this.sessionID&&this.sessionID===(null===(s=null===(n=this.notebookPanel)||void 0===n?void 0:n.sessionContext.session)||void 0===s?void 0:s.id)||(this.sessionID=null===(i=null===(t=this.notebookPanel)||void 0===t?void 0:t.sessionContext.session)||void 0===i?void 0:i.id);const c={eventDetail:e,notebookState:{sessionID:this.sessionID,workspaceID:this.workspaceID,notebookPath:null===(r=this.notebookPanel)||void 0===r?void 0:r.context.path,notebookContent:o?null===(a=null===(l=this.notebookPanel)||void 0===l?void 0:l.model)||void 0===a?void 0:a.toJSON():null}};u.forEach((e=>{"ConsoleLogger"==e.id&&(new e).consume(c)}))}}const k={id:g,description:"A JupyterLab extension.",provides:v,autoStart:!0,activate:async e=>{const o=await r("version");console.log(`${g}: ${o}`);const n=await r("consumerConfig");return console.log(n),new h}}}]]);