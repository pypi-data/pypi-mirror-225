"use strict";(self.webpackChunktelemetry_router=self.webpackChunktelemetry_router||[]).push([[21,834],{8341:(e,t,n)=>{n.r(t),n.d(t,{ITelemetryRouter:()=>k,TelemetryRouter:()=>y,default:()=>g});var o=n(7930),r=n(9526),a=n(1820),s=n(6339),c=n(2519),i=n(2380);async function l(e="",t={}){const n=i.ServerConnection.makeSettings(),o=c.URLExt.join(n.baseUrl,"telemetry-router",e);let r;try{r=await i.ServerConnection.makeRequest(o,t,n)}catch(e){throw new i.ServerConnection.NetworkError(e)}let a=await r.text();if(a.length>0)try{a=JSON.parse(a)}catch(e){console.log("Not a JSON response body.",r)}if(!r.ok)throw new i.ServerConnection.ResponseError(r,a.message||a);return a}var u=n(5978),v=n(3372),d=n(4526),p=n(3303),S=n(3145);(()=>{const e=new d.WebTracerProvider({resource:new p.Resource({[S.SemanticResourceAttributes.SERVICE_NAME]:"educational-technology-collective"})});e.addSpanProcessor(new u.SimpleSpanProcessor(new u.ConsoleSpanExporter)),e.addSpanProcessor(new u.SimpleSpanProcessor(new v.OTLPTraceExporter({}))),e.register()})();const w=r.g.getTracer("telemetry");let m;const b="telemetry-router:plugin",k=new o.Token(b);class y{loadNotebookPanel(e){this.notebookPanel=e}async publishEvent(e,t){var n,o,c;const{workspaceID:i}=await l("env");(e=>{if(e.eventDetail.eventName)if(m){const t=r.g.setSpan(s.D.active(),m),n=w.startSpan(e.eventDetail.eventName,void 0,t);n.setAttribute("event",JSON.stringify(e)),n.setStatus({code:a.Q.OK,message:"OK"}),n.end()}else m=w.startSpan(e.eventDetail.eventName),m.setAttribute("event",JSON.stringify(e)),m.setStatus({code:a.Q.OK,message:"OK"}),m.end()})({eventDetail:e,notebookState:{workspaceID:i,notebookPath:null===(n=this.notebookPanel)||void 0===n?void 0:n.context.path,notebookContent:t?null===(c=null===(o=this.notebookPanel)||void 0===o?void 0:o.model)||void 0===c?void 0:c.toJSON():null}})}}const g={id:b,description:"A JupyterLab extension.",provides:k,autoStart:!0,activate:async e=>{const t=await l("version");return console.log(`${b}: ${t}`),new y}}},5834:(e,t,n)=>{function o(e){return Symbol.for(e)}n.d(t,{I:()=>r,Y:()=>o});var r=new function e(t){var n=this;n._currentContext=t?new Map(t):new Map,n.getValue=function(e){return n._currentContext.get(e)},n.setValue=function(t,o){var r=new e(n._currentContext);return r._currentContext.set(t,o),r},n.deleteValue=function(t){var o=new e(n._currentContext);return o._currentContext.delete(t),o}}}}]);