"use strict";(self.webpackChunk_dagster_io_app_oss=self.webpackChunk_dagster_io_app_oss||[]).push([[268],{48977:function(n,e,t){t.d(e,{a:function(){return u}});var r,o=t(71171),i=t(90239),s=t(31623),u=function(){var n=(0,i.a)(l).data;return!(null===n||void 0===n||!n.instance.hasCapturedLogManager)},l=(0,s.Ps)(r||(r=(0,o.Z)(["\n  query InstanceSupportsCapturedLogs {\n    instance {\n      id\n      hasCapturedLogManager\n    }\n  }\n"])))},38708:function(n,e,t){t.d(e,{h:function(){return Z}});var r,o,i,s=t(96234),u=t(71171),l=t(33028),a=t(59740),c=t(78912),d=t(31623),p=t(90239),g=t(40302),f=t(69059),h=t(29427),v=t(78193),m=t(72593),y=t(93687),x=t(9549),b=t(35936),w=["logCaptureInfo"],Z=v.memo((function(n){var e=n.logCaptureInfo,t=(0,a.Z)(n,w),r=e&&("stdout"===t.visibleIOType?e.externalStdoutUrl:e.externalStderrUrl);return r?(0,b.jsxs)(g.x,{flex:{direction:"row",alignItems:"center",justifyContent:"center",gap:1},background:f.w.Gray900,style:{color:f.w.White,flex:1,minHeight:0},children:["View logs at",(0,b.jsx)("a",{href:r,target:"_blank",rel:"noreferrer",style:{color:f.w.White,textDecoration:"underline",marginLeft:4,marginRight:4},children:r}),(0,b.jsx)(h.JO,{name:"open_in_new",color:f.w.White,size:20,style:{marginTop:2}})]}):t.logKey.length?(0,b.jsx)(K,(0,l.Z)({},t)):null})),S=5242880,C=function(n){return n.length<S?n:n.slice(-5242880)},j=function(n,e){return e?C(n?n+e:e):n||null},L=function(n,e){var t,r,o;switch(e.type){case"update":return(0,l.Z)((0,l.Z)({},n),{},{isLoading:!1,cursor:null===(t=e.logData)||void 0===t?void 0:t.cursor,stdout:j(n.stdout,null===(r=e.logData)||void 0===r?void 0:r.stdout),stderr:j(n.stderr,null===(o=e.logData)||void 0===o?void 0:o.stderr)});case"metadata":return(0,l.Z)((0,l.Z)({},n),e.metadata);case"reset":return(0,l.Z)({},R);default:return n}},R={stdout:null,stderr:null,cursor:null,isLoading:!0},E=v.memo((function(n){var e=n.logKey,t=n.onLogData;return(0,c.m)(I,{fetchPolicy:"no-cache",variables:{logKey:e},onSubscriptionData:function(n){var e,r=n.subscriptionData;null!==(e=r.data)&&void 0!==e&&e.capturedLogs&&t(r.data.capturedLogs)}}),null})),I=(0,d.Ps)(r||(r=(0,u.Z)(["\n  subscription CapturedLogsSubscription($logKey: [String!]!, $cursor: String) {\n    capturedLogs(logKey: $logKey, cursor: $cursor) {\n      ...CapturedLog\n    }\n  }\n\n  fragment CapturedLog on CapturedLogs {\n    stdout\n    stderr\n    cursor\n  }\n"]))),k=(0,d.Ps)(o||(o=(0,u.Z)(["\n  query CapturedLogsMetadataQuery($logKey: [String!]!) {\n    capturedLogsMetadata(logKey: $logKey) {\n      stdoutDownloadUrl\n      stdoutLocation\n      stderrDownloadUrl\n      stderrLocation\n    }\n  }\n"]))),N=function(n){var e=n.logKey,t=n.children,r=v.useReducer(L,R),o=(0,s.Z)(r,2),i=o[0],u=o[1],l=JSON.stringify(e);v.useEffect((function(){u({type:"reset"})}),[l]);var a=v.useCallback((function(n){u({type:"update",logData:n})}),[]);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(E,{logKey:e,onLogData:a}),t(i)]})},T=function(n){var e=n.logKey,t=n.children,r=v.useReducer(L,R),o=(0,s.Z)(r,2),i=o[0],u=o[1],l=JSON.stringify(e);v.useEffect((function(){u({type:"reset"})}),[l]);var a=i.cursor,c=(0,p.a)(D,{notifyOnNetworkStatusChange:!0,variables:{logKey:e,cursor:a,limit:1e5},pollInterval:5e3,onCompleted:function(n){d(),u({type:"update",logData:n.capturedLogs}),g(5e3)}}),d=c.stopPolling,g=c.startPolling;return(0,b.jsx)(b.Fragment,{children:t(i)})},D=(0,d.Ps)(i||(i=(0,u.Z)(["\n  query CapturedLogsQuery($logKey: [String!]!, $cursor: String, $limit: Int) {\n    capturedLogs(logKey: $logKey, cursor: $cursor, limit: $limit) {\n      stdout\n      stderr\n      cursor\n    }\n  }\n"]))),K=v.memo((function(n){var e,t,r=n.logKey,o=n.visibleIOType,i=n.onSetDownloadUrl,s=v.useContext(m.I).rootServerURI,u=v.useContext(y.DN),l=u.availability,a=u.disabled,c=(0,p.a)(k,{variables:{logKey:r}});v.useEffect((function(){if(i&&c.data){var n="stdout"===o?c.data.capturedLogsMetadata.stdoutDownloadUrl:c.data.capturedLogsMetadata.stderrDownloadUrl;n&&(n.startsWith("/")?i(s+n):i(n))}}),[i,o,s,c.data]);var d=(null===(e=c.data)||void 0===e?void 0:e.capturedLogsMetadata.stdoutLocation)||void 0,g=(null===(t=c.data)||void 0===t?void 0:t.capturedLogsMetadata.stderrLocation)||void 0,f="unavailable"===l||a?T:N;return(0,b.jsx)("div",{style:{flex:1,minHeight:0,display:"flex",flexDirection:"column"},children:(0,b.jsx)(f,{logKey:r,children:function(n){return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(x.o,{logData:n.stdout,isLoading:n.isLoading,location:d,isVisible:"stdout"===o}),(0,b.jsx)(x.o,{logData:n.stderr,isLoading:n.isLoading,location:g,isVisible:"stderr"===o})]})}})})}))},90604:function(n,e,t){t.d(e,{K:function(){return Z}});var r,o=t(40302),i=t(83796),s=t(78193),u=t(72593),l=t(9549),a=t(71171),c=t(96234),d=t(33028),p=t(78912),g=t(31623),f=t(4534),h=5242880,v=function(n){return n.length<h?n:n.slice(-5242880)},m=function(n,e){if(!e)return n;var t=null===n||void 0===n?void 0:n.data;return null!==n&&void 0!==n&&n.data&&null!==e&&void 0!==e&&e.data?t=v(n.data+e.data):null!==e&&void 0!==e&&e.data&&(t=v(e.data)),{__typename:e.__typename,path:e.path,downloadUrl:e.downloadUrl,data:"string"===typeof t?t:null,cursor:e.cursor}},y=function(n,e){switch(e.type){case"stdout":var t=e.stepKey===n.stepKey?m(n.stdout,e.log):e.log;return(0,d.Z)((0,d.Z)({},n),{},{isLoading:!1,stdout:t});case"stderr":var r=e.stepKey===n.stepKey?m(n.stderr,e.log):e.log;return(0,d.Z)((0,d.Z)({},n),{},{isLoading:!1,stderr:r});default:return n}},x={stepKey:"",stdout:null,stderr:null,isLoading:!0},b=(0,g.Ps)(r||(r=(0,a.Z)(["\n  subscription ComputeLogsSubscription(\n    $runId: ID!\n    $stepKey: String!\n    $ioType: ComputeIOType!\n    $cursor: String\n  ) {\n    computeLogs(runId: $runId, stepKey: $stepKey, ioType: $ioType, cursor: $cursor) {\n      ...ComputeLogForSubscription\n    }\n  }\n\n  fragment ComputeLogForSubscription on ComputeLogFile {\n    path\n    cursor\n    data\n    downloadUrl\n  }\n"]))),w=t(35936),Z=function(n){var e=n.runId,t=n.computeLogFileKey,r=n.ioType,s=n.setComputeLogUrl;return t?(0,w.jsx)(C,{runId:e,computeLogFileKey:t,ioType:r,setComputeLogUrl:s}):(0,w.jsx)(o.x,{flex:{justifyContent:"center",alignItems:"center"},style:{flex:1,height:"100%"},children:(0,w.jsx)(i.$,{purpose:"section"})})},S=function(n,e){if(!e)return null;var t;return(t=e)&&t.startsWith("/")?n+e:e},C=s.memo((function(n){var e=n.runId,t=n.computeLogFileKey,r=n.ioType,o=n.setComputeLogUrl,i=s.useContext(u.I).rootServerURI,l=function(n,e){var t=s.useReducer(y,x),r=(0,c.Z)(t,2),o=r[0],i=r[1];return(0,p.m)(b,{fetchPolicy:"no-cache",variables:{runId:n,stepKey:e,ioType:f.E90.STDOUT,cursor:null},onSubscriptionData:function(n){var t,r=n.subscriptionData;i({type:"stdout",stepKey:e,log:(null===(t=r.data)||void 0===t?void 0:t.computeLogs)||null})}}),(0,p.m)(b,{fetchPolicy:"no-cache",variables:{runId:n,stepKey:e,ioType:f.E90.STDERR,cursor:null},onSubscriptionData:function(n){var t,r=n.subscriptionData;i({type:"stderr",stepKey:e,log:(null===(t=r.data)||void 0===t?void 0:t.computeLogs)||null})}}),o}(e,t),a=l.isLoading,d=l.stdout,g=l.stderr,h=S(i,(null===d||void 0===d?void 0:d.downloadUrl)||null),v=S(i,(null===g||void 0===g?void 0:g.downloadUrl)||null);return(0,w.jsxs)("div",{style:{flex:1,minHeight:0,display:"flex",flexDirection:"column"},children:[(0,w.jsx)(j,{content:d?d.data:null,path:d?d.path:void 0,downloadUrl:h,isLoading:a,isVisible:"stdout"===r,setComputeLogUrl:o}),(0,w.jsx)(j,{content:g?g.data:null,path:g?g.path:void 0,downloadUrl:v,isLoading:a,isVisible:"stderr"===r,setComputeLogUrl:o})]})})),j=function(n){var e=n.isLoading,t=n.isVisible,r=n.content,o=n.path,i=n.downloadUrl,u=n.setComputeLogUrl;return s.useEffect((function(){u(i)}),[u,i]),(0,w.jsx)(l.o,{logData:r,isLoading:e,isVisible:t,downloadUrl:i,location:o})}},19850:function(n,e,t){t.d(e,{C:function(){return k}});var r,o,i,s=t(71171),u=t(96234),l=t(33028),a=t(41361),c=t(68079),d=t(61794),p=t(78912),g=t(90239),f=t(31623),h=t(47317),v=t.n(h),m=t(78193),y=t(93687),x=t(4534),b=t(56420),w=t(21784),Z=t(35936),S={DEBUG:0,INFO:0,WARNING:0,ERROR:0,CRITICAL:0,EVENT:0},C=function(n,e){switch(e.type){case"append":var t=e.queued.map((function(n,e){return(0,l.Z)((0,l.Z)({},n),{},{clientsideKey:"csk".concat(n.timestamp,"-").concat(e)})})),r=[].concat((0,c.Z)(n.nodes),(0,c.Z)(t)),o=(0,l.Z)({},n.counts);return t.forEach((function(n){var e=(0,w.m)(n);o[e]++})),{nodes:r,counts:o,loading:e.hasMore,cursor:e.cursor};case"set-cursor":return(0,l.Z)((0,l.Z)({},n),{},{cursor:e.cursor});case"reset":return{nodes:[],counts:S,cursor:null,loading:!0};default:return n}},j={nodes:[],counts:S,cursor:null,loading:!0},L=function(n){var e=(0,d.x)(),t=m.useRef([]),r=m.useReducer(C,j),o=(0,u.Z)(r,2),i=o[0],s=o[1],p=m.useCallback((function(t){var r=e.readFragment({fragmentName:"PipelineRunLogsSubscriptionStatusFragment",fragment:T,id:"Run:".concat(n)});if(r){var o=(0,l.Z)((0,l.Z)({},r),{},{canTerminate:t===x.VOA.QUEUED||t===x.VOA.STARTED,status:t});e.writeFragment({fragmentName:"PipelineRunLogsSubscriptionStatusFragment",fragment:T,id:"Run:".concat(n),data:o})}}),[e,n]);m.useEffect((function(){t.current=[],s({type:"reset"})}),[n]);var g=m.useMemo((function(){return v()((function(){if(t.current.length){var n=(0,c.Z)(t.current);t.current=[];var e=n.flatMap((function(n){return n.messages})),r=n[n.length-1],o=r.hasMorePastEvents,i=r.cursor;s({type:"append",queued:e,hasMore:o,cursor:i});var u=function(n){var e,t=(0,c.Z)(n).reverse(),r=(0,a.Z)(t);try{for(r.s();!(e=r.n()).done;)switch(e.value.__typename){case"RunStartEvent":return x.VOA.STARTED;case"RunEnqueuedEvent":return x.VOA.QUEUED;case"RunStartingEvent":return x.VOA.STARTING;case"RunCancelingEvent":return x.VOA.CANCELING;case"RunCanceledEvent":return x.VOA.CANCELED;case"RunSuccessEvent":return x.VOA.SUCCESS;case"RunFailureEvent":return x.VOA.FAILURE}}catch(o){r.e(o)}finally{r.f()}return null}(e);u&&!o&&p(u)}}),100)}),[p]),f=i.nodes,h=i.counts,b=i.cursor,w=i.loading,S=m.useContext(y.DN),L=S.availability,E=S.disabled,I=S.status,k=!E&&"available"===L&&I===WebSocket.CLOSED,N=m.useRef(b);k&&(N.current=b);var D=N.current,K=m.useMemo((function(){return{runId:n,cursor:D}}),[n,D]),P=m.useMemo((function(){return(0,Z.jsx)(R,{variables:K,onSubscriptionData:function(n){var e,r=null===(e=n.subscriptionData.data)||void 0===e?void 0:e.pipelineRunLogs;r&&"PipelineRunLogsSubscriptionFailure"!==r.__typename&&(t.current.push(r),requestAnimationFrame(g))}})}),[K,g]);return m.useMemo((function(){return null!==f?{allNodes:f,counts:h,loading:w,subscriptionComponent:P}:{allNodes:[],counts:h,loading:w,subscriptionComponent:P}}),[h,w,f,P])},R=function(n){var e=n.variables,t=n.onSubscriptionData;return(0,p.m)(N,{fetchPolicy:"no-cache",variables:e,onSubscriptionData:t}),null},E=function(n){var e=L(n.runId);return(0,Z.jsxs)(Z.Fragment,{children:[e.subscriptionComponent,n.children(e)]})},I=function(n){var e=n.children,t=n.runId,r=m.useReducer(C,j),o=(0,u.Z)(r,2),i=o[0],s=o[1],l=i.counts,a=i.cursor,c=i.nodes,d=(0,g.a)(D,{notifyOnNetworkStatusChange:!0,variables:{runId:t,cursor:a,limit:1e4},pollInterval:5e3,onCompleted:function(n){if(p(),"Run"===(null===n||void 0===n?void 0:n.pipelineRunOrError.__typename)&&"EventConnection"===(null===n||void 0===n?void 0:n.logsForRun.__typename)){var e=n.pipelineRunOrError,t=n.logsForRun.events,r=e.status,o=n.logsForRun.cursor,i=!!r&&r!==x.VOA.FAILURE&&r!==x.VOA.SUCCESS&&r!==x.VOA.CANCELED;s({type:"append",queued:t,hasMore:i,cursor:o}),i&&f(5e3)}}}),p=d.stopPolling,f=d.startPolling;return(0,Z.jsx)(Z.Fragment,{children:e(null!==c&&c.length>0?{allNodes:c,counts:l,loading:!1}:{allNodes:[],counts:l,loading:!0})})},k=function(n){var e=n.children,t=n.runId,r=m.useContext(y.DN),o=r.availability,i=r.disabled;return"unavailable"===o||i?(0,Z.jsx)(I,{runId:t,children:e}):"attempting-to-connect"===o?(0,Z.jsx)(Z.Fragment,{children:e({allNodes:[],counts:S,loading:!0})}):(0,Z.jsx)(E,{runId:t,children:e})},N=(0,f.Ps)(r||(r=(0,s.Z)(["\n  subscription PipelineRunLogsSubscription($runId: ID!, $cursor: String) {\n    pipelineRunLogs(runId: $runId, cursor: $cursor) {\n      ... on PipelineRunLogsSubscriptionFailure {\n        missingRunId\n        message\n      }\n      ...RunLogsSubscriptionSuccess\n    }\n  }\n\n  fragment RunLogsSubscriptionSuccess on PipelineRunLogsSubscriptionSuccess {\n    messages {\n      ... on MessageEvent {\n        runId\n      }\n      ...RunDagsterRunEventFragment\n    }\n    hasMorePastEvents\n    cursor\n  }\n\n  ","\n"])),b.$K),T=(0,f.Ps)(o||(o=(0,s.Z)(["\n  fragment PipelineRunLogsSubscriptionStatusFragment on Run {\n    id\n    status\n    canTerminate\n  }\n"]))),D=(0,f.Ps)(i||(i=(0,s.Z)(["\n  query RunLogsQuery($runId: ID!, $cursor: String, $limit: Int) {\n    pipelineRunOrError(runId: $runId) {\n      ... on Run {\n        id\n        status\n        canTerminate\n      }\n    }\n    logsForRun(runId: $runId, afterCursor: $cursor, limit: $limit) {\n      ... on EventConnection {\n        events {\n          ... on MessageEvent {\n            runId\n          }\n          ...RunDagsterRunEventFragment\n        }\n        cursor\n      }\n      ... on PythonError {\n        message\n        stack\n      }\n    }\n  }\n\n  ","\n"])),b.$K)},63999:function(n,e,t){t.d(e,{hi:function(){return Y},KZ:function(){return X}});var r,o,i,s,u,l,a,c,d=t(56666),p=t(33028),g=t(71171),f=t(96234),h=t(40302),v=t(13793),m=t(14111),y=t(72979),x=t(85049),b=t(29427),w=t(34191),Z=t(83796),S=t(69059),C=t(14957),j=t(78193),L=t(60319),R=t(31362),E=t(27937),I=t(9127),k=t(47578),N=L.ZP.div(r||(r=(0,g.Z)(["\n  display: inline-block;\n  width: 11px;\n  height: 11px;\n  border-radius: 5.5px;\n  transition: background 200ms linear;\n  background: ",";\n  &:hover {\n    background: ",";\n  }\n"])),(function(n){var e,t=n.state;return(e={},(0,d.Z)(e,k.TN.RUNNING,S.w.Gray400),(0,d.Z)(e,k.TN.SUCCEEDED,S.w.Green700),(0,d.Z)(e,k.TN.SKIPPED,S.w.Yellow500),(0,d.Z)(e,k.TN.FAILED,S.w.Red500),(0,d.Z)(e,k.TN.PREPARING,S.w.Red500),(0,d.Z)(e,k.TN.RETRY_REQUESTED,S.w.Red500),(0,d.Z)(e,k.TN.UNKNOWN,S.w.Red500),e)[t]}),(function(n){var e,t=n.state;return(e={},(0,d.Z)(e,k.TN.RUNNING,S.w.Gray400),(0,d.Z)(e,k.TN.SUCCEEDED,S.w.Green700),(0,d.Z)(e,k.TN.SKIPPED,S.w.Yellow500),(0,d.Z)(e,k.TN.FAILED,S.w.Red200),(0,d.Z)(e,k.TN.PREPARING,S.w.Red500),(0,d.Z)(e,k.TN.RETRY_REQUESTED,S.w.Red500),(0,d.Z)(e,k.TN.UNKNOWN,S.w.Red500),e)[t]})),T=t(15888),D=t(78970),K=t(35936),P=function(n){var e=n.options,t=n.onSetFilter,r=j.useState(!1),o=(0,f.Z)(r,2),i=o[0],s=o[1],u=Object.keys(e),l=Object.values(e).reduce((function(n,e){return e.enabled?n+1:n}),0),a=function(n){return function(e){var r=e.target.checked;t(n,r)}};return(0,K.jsx)(T.J,{isOpen:i,placement:"bottom-start",canEscapeKeyClose:!0,onInteraction:function(n){return s(n)},content:(0,K.jsx)(y.v2,{style:{width:"180px"},"aria-label":"filter-options",children:u.map((function(n){var t=e[n],r=t.label,o=t.count,i=t.enabled;return(0,K.jsx)(y.sN,{tagName:"div",shouldDismissPopover:!1,text:(0,K.jsx)(h.x,{flex:{direction:"row",alignItems:"center"},padding:{horizontal:2},children:(0,K.jsx)(O,{id:"menu-check-".concat(n),checked:i,size:"small",onChange:a(n),label:(0,K.jsxs)(h.x,{flex:{direction:"row",justifyContent:"space-between",alignItems:"center"},style:{flex:1},children:[(0,K.jsx)("div",{children:r}),(0,K.jsx)("div",{style:{color:S.w.Gray500},children:(0,D.J)(o)})]})})})},n)}))}),children:(0,K.jsxs)(U,{onClick:function(){return s((function(n){return!n}))},icon:(0,K.jsx)(b.JO,{name:"filter_alt"}),rightIcon:(0,K.jsx)(b.JO,{name:"expand_more"}),children:["Levels (",l,")"]})})},U=(0,L.ZP)(x.zx)(o||(o=(0,g.Z)(["\n  justify-content: space-between;\n  width: 100%;\n"]))),O=(0,L.ZP)(C.X)(i||(i=(0,g.Z)(["\n  display: flex;\n  flex: 1;\n  align-items: center;\n"]))),F=t(4110),M=t(27589),A=t(53984),$=t(57980),_=function(n,e){switch(e.type){case"show-popover":return(0,p.Z)((0,p.Z)({},n),{},{shown:!0});case"hide-popover":return(0,p.Z)((0,p.Z)({},n),{},{shown:!1});case"highlight":return(0,p.Z)((0,p.Z)({},n),{},{highlight:e.highlight});case"change-query":return(0,p.Z)((0,p.Z)({},n),{},{shown:!0,highlight:0});case"select-suggestion":return(0,p.Z)((0,p.Z)({},n),{},{highlight:0});default:return n}},V={shown:!1,highlight:0},G={threshold:.3},q=function(n){var e=n.value,t=n.onChange,r=n.suggestionProviders,o=j.useReducer(_,V),i=(0,f.Z)(o,2),s=i[0],u=i[1],l=s.shown,a=s.highlight,c=j.useRef(null),g=j.useMemo((function(){var n=r.reduce((function(n,e){var t=e.values();return e.token?(0,p.Z)((0,p.Z)({},n),{},(0,d.Z)({},e.token,{fuse:new A.Z(t,G),all:t})):n}),{}),e=r.map((function(n){return n.token})).filter((function(n){return n}));return{empty:new A.Z(e,G),perProvider:n}}),[r]),h=g.empty,v=g.perProvider,m=j.useCallback((function(n){if(!n)return Object.keys(v);var e=n.split(":"),t=(0,f.Z)(e,2),r=t[0],o=t[1];if(r&&r in v){var i=v[r],s=i.fuse,u=i.all,l=o?s.search(o).map((function(n){return"".concat(r,":").concat(n.item)})):u.map((function(n){return"".concat(r,":").concat(n)}));return l.map((function(n){return n.toLowerCase()})).includes(n)?[]:l}return h.search(n).map((function(n){return n.item}))}),[h,v]),y=function(n,e){var t=e.toLocaleLowerCase().trim().split(/\s+/),r=t[t.length-1]||"",o=j.useMemo((function(){return n(r)}),[n,r]),i=j.useCallback((function(n){var t=e.toLocaleLowerCase().lastIndexOf(r);if(-1!==t){var o=e.slice(0,t);return"".concat(o).concat(n)}return e}),[r,e]);return j.useMemo((function(){return{suggestions:o,onSelectSuggestion:i}}),[i,o])}(m,e),x=y.suggestions,w=y.onSelectSuggestion,Z=x.length,S=x[a]||null,C=j.useCallback((function(n){u({type:"change-query"}),t(n.target.value)}),[t]),L=j.useCallback((function(n){u({type:"select-suggestion"}),t(w(n))}),[t,w]),R=j.useCallback((function(){var n;u({type:"change-query"}),t(""),null===(n=c.current)||void 0===n||n.focus()}),[t]);return(0,K.jsx)(T.J,{isOpen:l&&x.length>0,position:"bottom-left",content:(0,K.jsx)(W,{children:x.map((function(n,e){return(0,K.jsx)(H,{suggestion:n,isHighlight:a===e,onSelect:L},n)}))}),children:(0,K.jsx)(J,{placeholder:"Filter\u2026",spellCheck:!1,autoCorrect:"off",value:e,ref:c,onChange:C,onFocus:function(){return u({type:"show-popover"})},onBlur:function(){return u({type:"hide-popover"})},onKeyDown:function(n){var e=n.key;if("Escape"!==e){if(Z){var t=Z-1;switch(e){case"ArrowUp":n.preventDefault(),u({type:"highlight",highlight:0===a?t:a-1});break;case"ArrowDown":n.preventDefault(),u({type:"highlight",highlight:a===t?0:a+1});break;case"Enter":n.preventDefault(),S&&L(S)}}}else u({type:"hide-popover"})},rightElement:(0,K.jsx)($.C,{onClick:R,children:(0,K.jsx)(b.JO,{name:"cancel"})})})})},H=function(n){var e=n.suggestion,t=n.isHighlight,r=n.onSelect,o=j.useRef(null);return j.useEffect((function(){o.current&&t&&o.current.scrollIntoView({block:"nearest"})}),[t]),(0,K.jsx)(Q,{ref:o,isHighlight:t,onMouseDown:function(n){n.preventDefault(),r(e)},children:e})},J=(0,L.ZP)(M.oi)(s||(s=(0,g.Z)(["\n  width: 300px;\n"]))),W=L.ZP.ul(u||(u=(0,g.Z)(["\n  list-style: none;\n  margin: 0;\n  max-height: 200px;\n  max-width: 800px;\n  min-width: 300px;\n  overflow-y: auto;\n  padding: 4px 0;\n"]))),Q=L.ZP.li(l||(l=(0,g.Z)(["\n  align-items: center;\n  background-color: ",";\n  color: ",";\n  cursor: pointer;\n  display: flex;\n  flex-direction: row;\n  font-size: 12px;\n  list-style: none;\n  margin: 0;\n  padding: 4px 8px;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n\n  &:hover {\n    background-color: ",";\n  }\n"])),(function(n){return n.isHighlight?S.w.Blue500:S.w.White}),(function(n){return n.isHighlight?S.w.White:"default"}),(function(n){return n.isHighlight?S.w.Blue500:S.w.Gray100})),z=t(25296),B=t(88206),Y=function(n){return n.structured="structured",n.stdout="stdout",n.stderr="stderr",n}({}),X=function(n){var e=n.steps,t=n.metadata,r=n.counts,o=n.filter,i=n.onSetFilter,s=n.logType,u=n.onSetLogType,l=n.computeLogFileKey,a=n.onSetComputeLogKey,c=n.computeLogUrl,d=n.children,p=(0,I.U)("initial-compute-log-type",(function(n){return"string"===typeof n?n:Y.stdout})),g=(0,f.Z)(p,2),m=g[0],y=g[1],x=j.useCallback((function(n){y(n),u(n)}),[u,y]),b=j.useMemo((function(){return new Set([s===Y.structured?s:m])}),[s,m]);return(0,K.jsxs)(E.qn,{children:[(0,K.jsx)(h.x,{margin:{right:12},children:(0,K.jsx)(v.h,{activeItems:b,buttons:[{id:Y.structured,icon:"list",tooltip:"Structured event logs"},{id:m,icon:"wysiwyg",tooltip:"Raw compute logs"}],onClick:function(n){return u(n)}})}),"structured"===s?(0,K.jsx)(rn,{counts:r,filter:o,onSetFilter:i,showCopyURL:!d,steps:e}):(0,K.jsx)(en,{steps:e,metadata:t,logType:s,onSetLogType:x,computeLogFileKey:l,onSetComputeLogKey:a,computeLogUrl:c}),d]})},nn=function(n,e){return e.stepKeys.some((function(e){var t;return(null===(t=n.steps[e])||void 0===t?void 0:t.state)===k.TN.RUNNING}))?k.TN.RUNNING:e.stepKeys.some((function(e){var t;return(null===(t=n.steps[e])||void 0===t?void 0:t.state)===k.TN.SKIPPED}))?k.TN.SKIPPED:e.stepKeys.every((function(e){var t;return(null===(t=n.steps[e])||void 0===t?void 0:t.state)===k.TN.SUCCEEDED}))?k.TN.SUCCEEDED:k.TN.FAILED},en=function(n){var e=n.steps,t=n.metadata,r=n.computeLogFileKey,o=n.onSetComputeLogKey,i=n.logType,s=n.onSetLogType,u=n.computeLogUrl,l=t.logCaptureSteps||(0,k.co)(Object.keys(t.steps)),a=r&&l[r],c=!!a,d=function(n){if(!n||!l[n])return null;var e=l[n];return 1===e.stepKeys.length&&n===e.stepKeys[0]?n:e.pid&&1===e.stepKeys.length?e.stepKeys[0]:e.pid?"pid: ".concat(e.pid," (").concat(e.stepKeys.length," steps)"):"".concat(n," (").concat(e.stepKeys.length," steps)")};return(0,K.jsxs)(h.x,{flex:{justifyContent:"space-between",alignItems:"center",direction:"row"},style:{flex:1},children:[(0,K.jsxs)(h.x,{flex:{direction:"row",alignItems:"center",gap:12},children:[e?(0,K.jsx)(m.P,{disabled:!e.length,items:Object.keys(l),itemPredicate:function(n,e){return e.toLocaleLowerCase().includes(n.toLocaleLowerCase())},itemRenderer:function(n,e){return(0,K.jsx)(y.sN,{onClick:e.handleClick,text:d(n),active:e.modifiers.active},n)},activeItem:r,onItemSelect:function(n){o(n)},children:(0,K.jsx)(x.zx,{disabled:!e.length,rightIcon:(0,K.jsx)(b.JO,{name:"expand_more"}),children:d(r)||"Select a step..."})}):void 0,c?(0,K.jsx)(v.h,{activeItems:new Set([i]),onClick:s,buttons:[{id:Y.stdout,label:"stdout"},{id:Y.stderr,label:"stderr"}]}):null,e?void 0:(0,K.jsxs)(h.x,{children:["Step: ",((null===a||void 0===a?void 0:a.stepKeys)||[]).join(", ")]})]}),c?(0,K.jsxs)(h.x,{flex:{direction:"row",alignItems:"center",gap:12},children:[a?(0,K.jsx)(w.u,{placement:"top-end",content:"Status of this log capture group",children:nn(t,a)===k.TN.RUNNING?(0,K.jsx)(Z.$,{purpose:"body-text"}):(0,K.jsx)(N,{state:nn(t,a)})}):null,u?(0,K.jsx)(w.u,{placement:"top-end",content:1===(null===a||void 0===a?void 0:a.stepKeys.length)?"Download ".concat(null===a||void 0===a?void 0:a.stepKeys[0]," compute logs"):"Download compute logs",children:(0,K.jsx)(tn,{"aria-label":"Download link",href:u,download:!0,children:(0,K.jsx)(b.JO,{name:"download_for_offline",color:S.w.Gray600})})}):null]}):null]})},tn=L.ZP.a(a||(a=(0,g.Z)(["\n  border-radius: 4px;\n  display: block;\n  text-decoration: none;\n\n  "," {\n    transition: background-color 100ms linear;\n  }\n\n  :hover "," {\n    background-color: ",";\n  }\n\n  :active ",", :focus "," {\n    background-color: ",";\n  }\n\n  :focus {\n    outline: none;\n  }\n"])),b.a1,b.a1,S.w.Gray800,b.a1,b.a1,S.w.Dark),rn=function(n){var e,t=n.filter,r=n.counts,o=n.onSetFilter,i=n.steps,s=n.showCopyURL,u=j.useState("assignment"),l=(0,f.Z)(u,2),a=l[0],c=l[1],g=t.logQuery.map((function(n){var e=n.token,t=n.value;return e?"".concat(e,":").concat(t):t})).join(" "),v=j.useState((function(){return g})),m=(0,f.Z)(v,2),y=m[0],w=m[1],Z=(0,R.m)(),S=(0,I.U)(B.mF,B.nF),C=(0,f.Z)(S,2),L=(C[0],C[1]),k=(null===(e=t.logQuery.find((function(n){return"step"===n.token})))||void 0===e?void 0:e.value)||null,N=t.logQuery.reduce((function(n,e){return n+e.value}),"");j.useEffect((function(){w(g)}),[g]);var T=j.useCallback((function(n,e){var r=new Set(Object.keys(t.levels).filter((function(n){return!!t.levels[n]})));e?r.add(n):r.delete(n),L(Array.from(r)),o((0,p.Z)((0,p.Z)({},t),{},{levels:(0,p.Z)((0,p.Z)({},t.levels),{},(0,d.Z)({},n,e))}))}),[t,o,L]);j.useEffect((function(){var n;return"assignment_turned_in"===a&&(n=setTimeout((function(){c("assignment")}),2e3)),function(){n&&clearTimeout(n)}}),[a]);var D=Object.fromEntries(Object.keys(F.i).map((function(n){return[n,{label:n.toLowerCase(),count:r[n],enabled:!!t.levels[n]}]})));return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(q,{value:y,suggestionProviders:(0,z.m)(i),onChange:function(n){var e=n.split(/\s+/).map((function(n){var e=n.split(":");return e.length>1?{token:e[0],value:e[1]}:{value:e[0]}}));o((0,p.Z)((0,p.Z)({},t),{},{logQuery:e})),w(n)}}),N?(0,K.jsx)(on,{checked:t.hideNonMatches,onChange:function(n){return o((0,p.Z)((0,p.Z)({},t),{},{hideNonMatches:n.currentTarget.checked}))},label:"Hide non-matches"}):null,(0,K.jsx)(h.x,{flex:{direction:"row",alignItems:"center",gap:8},margin:{left:12},children:(0,K.jsx)(P,{options:D,onSetFilter:T})}),k&&(0,K.jsx)(E.KC,{}),(0,K.jsx)("div",{style:{minWidth:15,flex:1}}),s&&(0,K.jsx)(x.zx,{icon:(0,K.jsx)(b.JO,{name:a}),onClick:function(){Z(window.location.href),c("assignment_turned_in")},children:"Copy URL"})]})},on=(0,L.ZP)(C.X)(c||(c=(0,g.Z)(["\n  &&& {\n    margin: 0 4px 0 12px;\n  }\n\n  white-space: nowrap;\n"])))},9549:function(n,e,t){t.d(e,{o:function(){return T}});var r,o,i,s,u,l,a,c,d,p,g,f,h,v=t(71171),m=t(9249),y=t(87371),x=t(45754),b=t(86906),w=t(96234),Z=t(49668),S=t(29427),C=t(69059),j=t(83796),L=t(52714),R=t(24748),E=t.n(R),I=t(78193),k=t(60319),N=t(35936),T=I.memo((function(n){var e=n.logData,t=n.location,r=n.isLoading,o=n.isVisible,i=n.downloadUrl,s=I.useRef(null),u=I.useRef(),l=I.useState(!1),a=(0,w.Z)(l,2),c=a[0],d=a[1],p=function(){u.current&&(clearTimeout(u.current),u.current=0)},g=function(){d(!1),p()},f=function(){u.current=window.setTimeout(g,3e3)},h=e,v=D(h);if(h&&v){var m=h.indexOf("\n")+1,y=m<h.length?h.slice(m):h;h="\x1b[33m...logs truncated...\x1b[39m\n"+y}var x=v?(0,N.jsx)(W,{children:(0,N.jsxs)(Z.Z,{direction:"row",spacing:8,alignItems:"center",children:[(0,N.jsx)(S.JO,{name:"warning",color:C.w.Yellow500}),(0,N.jsxs)("div",{children:["This log has exceeded the 5MB limit."," ",i?(0,N.jsx)("a",{href:i,download:!0,children:"Download the full log file"}):null,"."]})]})}):null;return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(A,{isVisible:o,children:[c?(0,N.jsx)(H,{children:(0,N.jsx)(J,{onClick:function(){s.current&&s.current.scrollToTop()},onMouseOver:p,onMouseOut:f,children:(0,N.jsxs)(Z.Z,{direction:"row",spacing:8,alignItems:"center",children:[(0,N.jsx)(S.JO,{name:"arrow_upward",color:C.w.White}),"Scroll to top"]})})}):null,(0,N.jsxs)(_,{children:[x,(0,N.jsx)(V,{children:(0,N.jsx)(G,{isSelected:!0,content:e,onScrollUp:function(n){p(),n?(d(!0),f()):g()},onScrollDown:g,ref:s})})]}),r?(0,N.jsx)(q,{children:(0,N.jsx)(j.$,{purpose:"page"})}):null]}),t?(0,N.jsx)($,{isVisible:o,children:t}):null]})})),D=function(n){return!!n&&(new TextEncoder).encode(n).length>=5242880},K=function(n){(0,x.Z)(t,n);var e=(0,b.Z)(t);function t(){var n;(0,m.Z)(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(n=e.call.apply(e,[this].concat(o))).container=I.createRef(),n.lastScroll=0,n.onScroll=function(){if(n.container.current&&n.props.isSelected){var e=n.props,t=e.onScrollUp,r=e.onScrollDown,o=n.container.current,i=o.scrollHeight,s=o.scrollTop/(i-o.offsetHeight);n.container.current.scrollTop<n.lastScroll?t&&t(s):r&&r(s),n.lastScroll=n.container.current.scrollTop}},n}return(0,y.Z)(t,[{key:"componentDidMount",value:function(){this.scrollToBottom(),this.container.current&&(this.container.current.focus(),this.container.current.addEventListener("scroll",this.onScroll))}},{key:"getSnapshotBeforeUpdate",value:function(){if(!this.container.current)return!1;var n=this.container.current,e=n.scrollHeight,t=n.scrollTop;return n.offsetHeight+t>=e}},{key:"componentDidUpdate",value:function(n,e,t){t&&this.scrollToBottom(),this.props.isSelected&&!n.isSelected&&this.container.current&&this.container.current.focus()}},{key:"focus",value:function(){var n=this.container.current;n&&n.focus()}},{key:"scrollToBottom",value:function(){var n=this.container.current;n&&(n.scrollTop=n.scrollHeight-n.offsetHeight)}},{key:"scrollToTop",value:function(){var n=this.container.current;n&&(n.scrollTop=0,n.focus())}},{key:"render",value:function(){var n=this.props,e=n.content,t=n.className;return e?(0,N.jsx)("div",{className:t,style:{outline:"none"},ref:this.container,tabIndex:0,children:(0,N.jsxs)(M,{children:[(0,N.jsx)(P,{content:e}),(0,N.jsxs)(U,{children:[(0,N.jsx)(F,{}),(0,N.jsx)(E(),{linkify:!1,useClasses:!0,children:e})]})]})}):(0,N.jsx)("div",{className:t,ref:this.container,children:(0,N.jsx)(M,{style:{justifyContent:"center",alignItems:"center"},children:null==e?"No log file available":"No output"})})}}]),t}(I.Component),P=function(n){var e=n.content;if(!e)return null;var t=e.match(/\n/g),r=t?t.length:0;return(0,N.jsx)(O,{children:Array.from(Array(r),(function(n,e){return(0,N.jsx)("div",{children:String(e+1)},e)}))})},U=k.ZP.div(r||(r=(0,v.Z)(["\n  padding: 10px;\n  background-color: ",";\n"])),C.w.Gray900),O=k.ZP.div(o||(o=(0,v.Z)(["\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n  border-right: 1px solid #5c7080;\n  padding: 10px 10px 10px 20px;\n  margin-right: 5px;\n  background-color: ",";\n  opacity: 0.8;\n  color: #858585;\n  min-height: 100%;\n"])),C.w.Gray900),F=(0,k.vJ)(i||(i=(0,v.Z)(["\n  .ansi-black {\n    color: #586e75;\n  }\n  .ansi-red {\n    color: #dc322f;\n  }\n  .ansi-green {\n    color: #859900;\n  }\n  .ansi-yellow {\n    color: #b58900;\n  }\n  .ansi-blue {\n    color: #268bd2;\n  }\n  .ansi-magenta {\n    color: #d33682;\n  }\n  .ansi-cyan {\n    color: #2aa198;\n  }\n  .ansi-white {\n    color: #eee8d5;\n  }\n"]))),M=k.ZP.div(s||(s=(0,v.Z)(["\n  display: flex;\n  flex-direction: row;\n  min-height: 100%;\n  background-color: ",";\n"])),C.w.Gray900),A=k.ZP.div(u||(u=(0,v.Z)(["\n  flex: 1;\n  height: 100%;\n  position: relative;\n  &:first-child {\n    border-right: 0.5px solid #5c7080;\n  }\n  display: flex;\n  flex-direction: column;\n  ","\n"])),(function(n){return n.isVisible?null:"display: none;"})),$=k.ZP.div(l||(l=(0,v.Z)(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  height: 30px;\n  background-color: ",";\n  border-top: 0.5px solid #5c7080;\n  color: #aaaaaa;\n  padding: 2px 5px;\n  font-size: 0.85em;\n  ","\n"])),C.w.Gray900,(function(n){return n.isVisible?null:"display: none;"})),_=k.ZP.div(a||(a=(0,v.Z)(["\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n"]))),V=k.ZP.div(c||(c=(0,v.Z)(["\n  flex: 1;\n  position: relative;\n"]))),G=(0,k.ZP)(K)(d||(d=(0,v.Z)(["\n  color: #eeeeee;\n  font-family: ",";\n  font-size: 16px;\n  white-space: pre;\n  overflow: auto;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n"])),L.b.monospace),q=k.ZP.div(p||(p=(0,v.Z)(["\n  display: flex;\n  justifycontent: center;\n  alignitems: center;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  backgroundcolor: ",";\n  opacity: 0.3;\n"])),C.w.Gray800),H=k.ZP.div(g||(g=(0,v.Z)(["\n  position: absolute;\n  height: 30px;\n  top: 0;\n  left: 0;\n  right: 0;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: flex-start;\n  z-index: 1;\n"]))),J=k.ZP.div(f||(f=(0,v.Z)(["\n  background-color: black;\n  padding: 10px 20px;\n  border-bottom-right-radius: 5px;\n  border-bottom-left-radius: 5px;\n  color: white;\n  border-bottom: 0.5px solid #5c7080;\n  border-left: 0.5px solid #5c7080;\n  border-right: 0.5px solid #5c7080;\n  cursor: pointer;\n"]))),W=k.ZP.div(h||(h=(0,v.Z)(["\n  background-color: #fffae3;\n  padding: 10px 20px;\n  margin: 20px 70px;\n  border-radius: 5px;\n"])))},74545:function(n,e,t){t.d(e,{c:function(){return s},r:function(){return u}});var r=t(96234),o=t(78193),i=t(54202),s=function(n,e){var t=(n?Object.values(n):[]).find((function(n){return n.stepKeys.includes(e)}));return t&&(null===t||void 0===t?void 0:t.fileKey)};function u(n){var e=n.stepKeys,t=n.selectionStepKeys,u=n.metadata,l=(0,i.q)({queryKey:"logFileKey"}),a=(0,r.Z)(l,2),c=a[0],d=a[1];return o.useEffect((function(){if(null!==e&&void 0!==e&&e.length&&!c)if(u.logCaptureSteps){var n=Object.keys(u.logCaptureSteps),r=n.find((function(n){return t.every((function(e){return u.logCaptureSteps&&u.logCaptureSteps[n].stepKeys.includes(e)}))}));d(r||n[0])}else if(e.includes(c)){if(1===t.length&&c!==t[0]){var o=s(u.logCaptureSteps,t[0]);o&&d(o)}}else{var i=s(u.logCaptureSteps,1===t.length?t[0]:e[0]);i&&d(i)}}),[e,c,t,u.logCaptureSteps,d]),{logCaptureInfo:u.logCaptureSteps&&c in u.logCaptureSteps?u.logCaptureSteps[c]:void 0,computeLogFileKey:c,setComputeLogFileKey:d}}},88206:function(n,e,t){t.d(e,{Bz:function(){return x},mF:function(){return m},nF:function(){return y}});var r=t(96234),o=t(56666),i=t(33028),s=t(87683),u=t(78193),l=t(54202),a=t(9127),c=t(4110),d=t(25296),p="|";function g(n){return n.sort().map((function(n){return n.toLowerCase()})).join(p)}var f={steps:"*",logs:"",levels:g(c.w),hideNonMatches:"true",focusedTime:""},h=function(n){var e=n.logs||"",t=n.focusedTime||"",r=n.hideNonMatches||"",u=n.levels||"",l=e.split(p),a=t&&!e?Number(t):null,g="true"===r,f=(0,d.m)();return{sinceTime:0,focusedTime:a,hideNonMatches:g,logQuery:l.map((function(n){return(0,s.WD)(n,f)})),levels:u.split(p).map((function(n){return n.toUpperCase()})).filter((function(n){return c.i.hasOwnProperty(n)})).reduce((function(n,e){return(0,i.Z)((0,i.Z)({},n),{},(0,o.Z)({},e,!0))}),{})}};function v(n){var e=n.logQuery.map((function(n){return n.token?"".concat(n.token,":").concat(n.value):n.value}));return{hideNonMatches:n.hideNonMatches?"true":"false",focusedTime:n.focusedTime||"",logs:e.join(p),levels:g(Object.keys(n.levels).filter((function(e){return!!n.levels[e]})))}}var m="EnabledRunLogLevels",y=function(n){if(void 0===n||!Array.isArray(n))return null;var e=new Set(Object.keys(c.i));return n.filter((function(n){return e.has(n)}))};function x(){var n=(0,a.U)(m,y),e=(0,r.Z)(n,1)[0],t=u.useMemo((function(){var n=null!==e&&void 0!==e?e:c.w;return(0,i.Z)((0,i.Z)({},f),{},{levels:g(n)})}),[e]);return(0,l.q)({encode:v,decode:h,defaults:t})}}}]);
//# sourceMappingURL=268.6da407b6.chunk.js.map